# ç¬¬31ç«  null/undefinedæ•´ç†â‘¡ï¼ˆå®‰å…¨ãªæ›¸ãæ–¹ï¼‰ğŸ›ŸğŸ§·

### ã­ã‚‰ã„ğŸ¯

* `null/undefined` ãŒæ··ã–ã£ã¦ã‚‚**è½ã¡ãªã„**æ›¸ãæ–¹ã‚’èº«ã«ã¤ã‘ã‚‹ğŸ§¯âœ¨
* ã€Œã¨ã‚Šã‚ãˆãš `!`ã€ã‚’å’æ¥­ã—ã¦ã€**å®‰å…¨ã«èª­ã¿ã‚„ã™ã**ç›´ã›ã‚‹ã‚ˆã†ã«ãªã‚‹ğŸ“ğŸ§·
* â€œãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤â€ã¨â€œç•°å¸¸æ‰±ã„â€ã‚’ä½¿ã„åˆ†ã‘ã¦ã€ä»•æ§˜ãƒ–ãƒ¬ã‚’æ¸›ã‚‰ã™ğŸ§­ğŸ’¡

> å‚è€ƒï¼šç¾è¡Œã®æœ€æ–°ã¯ TypeScript 5.9 ç³»ï¼ˆnpm / å…¬å¼Downloadãƒšãƒ¼ã‚¸ã§ â€œcurrently 5.9â€ï¼‰ã§ã€6.0 ã¯ 7.0 ã¸ã®æ©‹æ¸¡ã—ã¨ã—ã¦æ¡ˆå†…ã•ã‚Œã¦ã„ã¾ã™ã€‚([TypeScript][1])

---

### ä»Šæ—¥ã®ã‚´ãƒ¼ãƒ«âœ…

ã“ã®ç« ãŒçµ‚ã‚ã£ãŸã‚‰ã€æ¬¡ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã‚ˆğŸŒ¸

* `?.` ã¨ `??` ã‚’ä½¿ã£ã¦ã€**å®‰å…¨ã‚¢ã‚¯ã‚»ã‚¹ï¼‹ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**ãŒæ›¸ã‘ã‚‹ğŸ§·ğŸ›Ÿ
* ã€Œç„¡ã„ãªã‚‰ç„¡ã„ã§OKã€ãªã®ã‹ã€Œç„¡ã„ã®ã¯ã‚¨ãƒ©ãƒ¼ã€ãªã®ã‹ã‚’**ã‚³ãƒ¼ãƒ‰ã§è¡¨ç¾**ã§ãã‚‹ğŸš¦âœ¨
* é…åˆ—ãƒ»è¾æ›¸ãƒ»ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å‘¨ã‚Šã® â€œã†ã£ã‹ã‚Šundefinedâ€ ã‚’æ¸›ã‚‰ã›ã‚‹ğŸ§ºğŸ§¹

---

## ã¾ãšè¦šãˆã‚‹ï¼å®‰å…¨ãª3ç‚¹ã‚»ãƒƒãƒˆğŸ§°âœ¨

### â‘  ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ãƒã‚§ãƒ¼ãƒ³ `?.`ï¼ˆç„¡ã„ãªã‚‰ãã“ã§æ­¢ã¾ã‚‹ï¼‰â›”ï¸â¡ï¸ğŸ«§

* `a?.b` / `a?.[0]` / `a?.()` ã¿ãŸã„ã«æ›¸ã‘ã‚‹ã‚ˆğŸ™‚
* `a` ãŒ `null/undefined` ãªã‚‰ã€**ä¾‹å¤–ã‚’æŠ•ã’ãšã« `undefined` ã«ãªã‚‹**ğŸ›Ÿ
  ([MDN Web Docs][2])

---

### â‘¡ Nullåˆä½“ `??`ï¼ˆâ€œ0â€ã‚„â€œç©ºæ–‡å­—â€ã¯å°Šé‡ã™ã‚‹ï¼‰ğŸ«¶ğŸ”¢

* å·¦ãŒ `null` ã¾ãŸã¯ `undefined` ã®ã¨ãã ã‘å³ã‚’ä½¿ã†ã‚ˆğŸ§·
* `||` ã¨é•ã£ã¦ã€`0` ã‚„ `""` ã‚’ã€Œç„¡ã„ã€æ‰±ã„ã—ãªã„ã®ãŒãƒã‚¤ãƒ³ãƒˆâœ¨
  ([MDN Web Docs][3])

---

### â‘¢ ã‚¬ãƒ¼ãƒ‰ç¯€ï¼ˆæ—©æœŸreturnï¼‰ğŸš¦âœ¨

ã€Œç„¡ã„ãªã‚‰é€²ã¾ãªã„ã€ã‚’æœ€åˆã«æ›¸ã„ã¦ã€ãƒã‚¹ãƒˆã‚‚äº‹æ•…ã‚‚æ¸›ã‚‰ã™ğŸ’ª

* ä¾‹ï¼š`if (user == null) return ...;`ï¼ˆ`null` ã¨ `undefined` ä¸¡æ–¹ã‚’ã¾ã¨ã‚ã¦åˆ¤å®šã§ãã‚‹ã‚ˆï¼‰ğŸ§ 

---

## ãƒ‘ã‚¿ãƒ¼ãƒ³é›†ï¼ˆã‚³ãƒ”ãƒšã—ã¦OKï¼‰ğŸ“šğŸ’•

### ãƒ‘ã‚¿ãƒ¼ãƒ³Aï¼šå®‰å…¨ã‚¢ã‚¯ã‚»ã‚¹ã ã‘ã—ãŸã„ï¼ˆè½ã¡ãŸããªã„ï¼‰ğŸ§·

```ts
const city = user?.address?.city; // string | undefined
```

* â€œç„¡ã‘ã‚Œã° undefinedâ€ ãŒè‡ªç„¶ãªå ´é¢ã§å¼·ã„ğŸ«§

---

### ãƒ‘ã‚¿ãƒ¼ãƒ³Bï¼šå®‰å…¨ã‚¢ã‚¯ã‚»ã‚¹ï¼‹ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼ˆUIè¡¨ç¤ºã§ã‚ˆãä½¿ã†ï¼‰ğŸ–¼ï¸âœ¨

```ts
const displayName = user?.profile?.nickname ?? "ã‚²ã‚¹ãƒˆ";
```

* `nickname = ""`ï¼ˆç©ºæ–‡å­—ï¼‰ã‚’ã€Œæœ¬äººãŒç©ºã«ã—ãŸã€æ‰±ã„ã—ãŸã„ãªã‚‰ `??` ãŒæ­£è§£ğŸ‘Œ

---

### ãƒ‘ã‚¿ãƒ¼ãƒ³Cï¼š`||` ã‚’ `??` ã«ç›´ã—ã¦ â€œ0äº‹æ•…â€ ã‚’é˜²ãğŸ”§ğŸ›Ÿ

**ãƒ“ãƒ•ã‚©ãƒ¼ï¼ˆåœ°å‘³ã«ãƒã‚°ã‚‹ï¼‰**ğŸ˜µ

```ts
const timeoutMs = config.timeoutMs || 3000; // timeoutMs=0 ãŒæ½°ã‚Œã‚‹
```

**ã‚¢ãƒ•ã‚¿ãƒ¼ï¼ˆä»•æ§˜ã©ãŠã‚Šï¼‰**ğŸ˜Š

```ts
const timeoutMs = config.timeoutMs ?? 3000;
```

* `||` ã¯ã€Œfalsyï¼ˆ0/""/falseï¼‰ã€ã‚‚å³ã«è¡Œãã‹ã‚‰æ³¨æ„âš ï¸
  ([MDN Web Docs][3])

---

### ãƒ‘ã‚¿ãƒ¼ãƒ³Dï¼šãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’â€œä»£å…¥â€ã—ãŸã„ `??=`ï¼ˆè¨­å®šç³»ã«ä¾¿åˆ©ï¼‰ğŸ§°âœ¨

```ts
type Options = { retries?: number | null };

function normalize(o: Options) {
  o.retries ??= 3;   // null/undefined ã®ã¨ãã ã‘ 3 ã‚’å…¥ã‚Œã‚‹
  return o;
}
```

([MDN Web Docs][4])

---

### ãƒ‘ã‚¿ãƒ¼ãƒ³Eï¼šã€Œç„¡ã„ã®ã¯ã‚¨ãƒ©ãƒ¼ã€ãªã‚‰ã€æœ€åˆã«æ­¢ã‚ã‚‹ğŸš¨

ã€Œç„¡ã„ã®ã«é€²ã‚ã‚‹ã€ã‚ˆã‚Šã€**åˆ†ã‹ã‚Šã‚„ã™ã„ã‚¨ãƒ©ãƒ¼**ã«ã™ã‚‹æ–¹ãŒå®‰å…¨ãªã“ã¨ã‚‚å¤šã„ã‚ˆğŸ§¯

```ts
function requireUser(user: { id: string } | null | undefined) {
  if (user == null) {
    throw new Error("user is required");
  }
  return user; // ã“ã“ã‹ã‚‰ user ã¯å¿…ãšå­˜åœ¨
}
```

---

### ãƒ‘ã‚¿ãƒ¼ãƒ³Fï¼š`!`ï¼ˆnon-null assertionï¼‰ã¯â€œæœ€å¾Œã®æ‰‹æ®µâ€ã«ã™ã‚‹ğŸ™…â€â™€ï¸

```ts
user!.profile!.nickname! // â† ã“ã‚Œã€å®Ÿè¡Œæ™‚ã¯æ™®é€šã«è½ã¡ã‚‹å¯èƒ½æ€§ã‚ã‚‹ğŸ˜­
```

* `!` ã¯ã€Œå‹ã ã‘é»™ã‚‰ã›ã‚‹ã€ã®ã§ã€äº‹æ•…ãŒ**å®Ÿè¡Œæ™‚ã«æ¥ã‚‹**ğŸ˜±
* ã¾ãšã¯ **ã‚¬ãƒ¼ãƒ‰ç¯€**ã‹ **`?.` `??`** ã§ç›´ã™ã®ãŒåŸºæœ¬ğŸ§·

---

## ä¾‹é¡Œï¼šè½ã¡ã‚„ã™ã„ã‚³ãƒ¼ãƒ‰ã‚’å®‰å…¨åŒ–ã—ã‚ˆã†ğŸ› ï¸ğŸ’•

### ãŠé¡Œï¼šã‚¯ãƒ¼ãƒãƒ³å‰²å¼•ã‚’è¡¨ç¤ºã—ãŸã„ğŸŸï¸âœ¨

ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚¯ãƒ¼ãƒãƒ³ãŒã‚ã‚Œã°å‰²å¼•ç‡ã‚’ã€ç„¡ã‘ã‚Œã° 0% ã‚’å‡ºã—ãŸã„ã€

**ãƒ“ãƒ•ã‚©ãƒ¼ï¼ˆè½ã¡ã‚‹ï¼†ãƒã‚°ã‚Šã‚„ã™ã„ï¼‰**ğŸ’¥

```ts
type Coupon = { discountPercent?: number | null };
type User = { coupons?: Coupon[] | null };

export function getDiscountPercent(user: User | null) {
  const first = user!.coupons![0];          // ğŸ’¥ user/coupons ãŒç„¡ã„ã¨è½ã¡ã‚‹
  return first.discountPercent || 0;        // ğŸ˜µ 0% ãŒ â€œç„¡ã„â€ æ‰±ã„ã«ãªã‚‹
}
```

**ã‚¢ãƒ•ã‚¿ãƒ¼ï¼ˆè½ã¡ãªã„ï¼†ä»•æ§˜ã©ãŠã‚Šï¼‰**ğŸ›Ÿâœ¨

```ts
type Coupon = { discountPercent?: number | null };
type User = { coupons?: Coupon[] | null };

export function getDiscountPercent(user: User | null): number {
  const first = user?.coupons?.at(0);              // ç„¡ã‘ã‚Œã° undefined
  return first?.discountPercent ?? 0;              // null/undefined ã ã‘ 0
}
```

ã“ã“ãŒè¶…å¤§äº‹ãƒã‚¤ãƒ³ãƒˆğŸ’¡

* ã€Œã‚¯ãƒ¼ãƒãƒ³ãŒç„¡ã‘ã‚Œã° 0%ã€ï¼**æ­£å¸¸ç³»ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**ã ã‹ã‚‰ `?? 0` ãŒè‡ªç„¶ğŸŒ¸
* ã€Œçµ¶å¯¾ã‚¯ãƒ¼ãƒãƒ³ãŒå¿…è¦ã€ãªä»•æ§˜ãªã‚‰ã€ä¸Šã®ãƒ‘ã‚¿ãƒ¼ãƒ³Eã¿ãŸã„ã« **throw** ã‚’é¸ã¶æ–¹ãŒå®‰å…¨ğŸš¨

---

## â€œç„¡ã„â€ã‚’ã©ã†æ‰±ã†ï¼ŸãƒŸãƒ‹æ–¹é‡ï¼ˆè¿·ã£ãŸã‚‰ã“ã‚Œï¼‰ğŸ§­âœ¨

### 1) è¡¨ç¤ºãƒ»UIï¼šç„¡ã„ãªã‚‰ãã‚Œã£ã½ãåŸ‹ã‚ã‚‹ğŸ–¼ï¸

* `?? "æœªè¨­å®š"` / `?? 0` / `?? []` ãŒå¤šã„ã‚ˆğŸ˜Š

### 2) ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ï¼šç„¡ã„ãªã‚‰æ­¢ã‚ã‚‹ğŸš¨

* æœŸå¾…ã—ã¦ã‚‹å…¥åŠ›ãŒç„¡ã„ãªã‚‰ã€æ—©ã‚ã« **throw** / **return** ã§æ­¢ã‚ã‚‹
* ãƒã‚°ã®ä½ç½®ãŒåˆ†ã‹ã‚Šã‚„ã™ããªã‚‹ğŸ§¯

---

## tsconfigã§ â€œã†ã£ã‹ã‚Šundefinedâ€ ã‚’æ—©ã‚ã«æ½°ã™ğŸ§·ğŸ‘®â€â™€ï¸

### ç‰¹ã«åŠ¹ã3ã¤âš¡ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒè¨±ã™ãªã‚‰ONæ¨å¥¨ï¼‰

* `strictNullChecks`ï¼š`null/undefined` ã‚’ã¡ã‚ƒã‚“ã¨å‹ã§æ‰±ã†ğŸ§·
* `noUncheckedIndexedAccess`ï¼š`arr[i]` ã‚„ `obj[key]` ã« `| undefined` ã‚’è¶³ã—ã¦ãã‚Œã‚‹ï¼ˆå–ã‚Šã“ã¼ã—æ¸›ã‚‹ï¼‰ğŸ›Ÿ
* `exactOptionalPropertyTypes`ï¼š`x?: T` ã¨ `x?: T | undefined` ã‚’åŒºåˆ¥ã—ã¦ãã‚Œã¦ã€æ›–æ˜§ã•ãŒæ¸›ã‚‹ğŸ¯

å…¬å¼ã®ãƒ•ãƒ©ã‚°èª¬æ˜ï¼ˆTSConfig / compiler optionsï¼‰ã«ã‚‚è¼‰ã£ã¦ã‚‹ã‚ˆğŸ“˜([TypeScript][5])

---

## æ‰‹é †ï¼ˆå°ã•ãåˆ»ã‚€ï¼‰ğŸ‘£ğŸ›Ÿ

1. **è½ã¡ã‚‹å ´æ‰€ã‚’ç‰¹å®š**ï¼ˆä¾‹ï¼š`Cannot read properties of undefined`ï¼‰ğŸ”
2. ãã®å ´æ‰€ã«ã€Œç„¡ã„ãªã‚‰ã©ã†ã™ã‚‹ï¼Ÿã€ã‚’æ±ºã‚ã‚‹ğŸ§­

   * ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ã™ã‚‹ï¼Ÿï¼ˆ`??`ï¼‰
   * ãã“ã§çµ‚äº†ï¼Ÿï¼ˆã‚¬ãƒ¼ãƒ‰ç¯€ï¼‰
   * ã‚¨ãƒ©ãƒ¼ã«ã™ã‚‹ï¼Ÿï¼ˆthrowï¼‰
3. **`!` ã‚’å¤–ã—ã¦**ã€`?.` / `??` / ã‚¬ãƒ¼ãƒ‰ç¯€ã§ç½®ãæ›ãˆã‚‹ğŸ§·âœ¨
4. å‹ãƒã‚§ãƒƒã‚¯ï¼†ãƒ†ã‚¹ãƒˆã§ç¢ºèªâœ…ğŸ§ª
5. â€œåŒã˜æ‚©ã¿â€ãŒä»–ã«ã‚‚ãªã„ã‹æ¤œç´¢ã—ã¦ã€åŒãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã¾ã¨ã‚ã¦ç›´ã™ğŸ”ğŸ§¹

---

## ãƒŸãƒ‹èª²é¡Œâœï¸ğŸŒ¸ï¼ˆ15ã€œ25åˆ†ï¼‰

### èª²é¡Œ1ï¼š`||` ã‚’ `??` ã«ç›´ã—ã¦ä»•æ§˜ãƒã‚°ã‚’æ¶ˆã™ğŸ§¯

æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’ã€`0` ã‚„ `""` ãŒæ½°ã‚Œãªã„ã‚ˆã†ã«ç›´ã—ã¦ã­ğŸ™‚

```ts
export function normalize(input: { retries?: number; label?: string }) {
  const retries = input.retries || 3;
  const label = input.label || "default";
  return { retries, label };
}
```

---

### èª²é¡Œ2ï¼šã‚¬ãƒ¼ãƒ‰ç¯€ã§ãƒã‚¹ãƒˆã‚’æ¸›ã‚‰ã™ğŸš¦âœ¨

```ts
export function getFirstTag(user?: { tags?: string[] }) {
  if (user) {
    if (user.tags) {
      if (user.tags.length > 0) {
        return user.tags[0];
      }
    }
  }
  return "no-tag";
}
```

* â€œæ—©æœŸreturnâ€ ã§ã‚¹ãƒƒã‚­ãƒªã•ã›ã¦ã­ğŸ‘£âœ¨

---

### èª²é¡Œ3ï¼š`!` ã‚’å’æ¥­ã™ã‚‹ğŸ“ğŸ§·

```ts
type Profile = { nickname?: string | null };
export function hello(p?: Profile) {
  return "Hi " + p!.nickname!.toUpperCase();
}
```

* è½ã¡ãªã„å½¢ã«ã—ã¦ã€`nickname` ãŒç„¡ã„æ™‚ã¯ `"Hi guest"` ã«ã—ã¦ã¿ã‚ˆã†ğŸ˜Š

---

## AIæ´»ç”¨ãƒã‚¤ãƒ³ãƒˆğŸ¤–âœ…ï¼ˆãŠé¡˜ã„æ–¹ï¼‹ãƒã‚§ãƒƒã‚¯è¦³ç‚¹ï¼‰

### ä¾¿åˆ©ãªãŠé¡˜ã„æ–¹ï¼ˆãã®ã¾ã¾æŠ•ã’ã¦OKï¼‰ğŸ“

* ã€Œã“ã®é–¢æ•°ã€`null/undefined` ã§è½ã¡ã‚‹å¯èƒ½æ€§ã‚’åˆ—æŒ™ã—ã¦ã€**å®‰å…¨åŒ–ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’3æ¡ˆ**ãã ã•ã„ã€‚`!` ã¯ä½¿ã‚ãªã„ã§ã€ğŸ¤–ğŸ›Ÿ
* ã€Œ`||` ã‚’ä½¿ã£ã¦ã‚‹ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚’ã€`??` ã«ç›´ã™ã¹ãç®‡æ‰€ãŒã‚ã‚‹ï¼Ÿç†ç”±ã‚‚ã€ğŸ¤–ğŸ”
* ã€Œã“ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚¬ãƒ¼ãƒ‰ç¯€ã§ãƒªãƒ•ã‚¡ã‚¯ã‚¿ã—ã¦ã€‚**æŒ™å‹•ã¯å¤‰ãˆãªã„**ã§ã€å·®åˆ†ã¯å°ã•ãã€ğŸ¤–ğŸ‘£

### AIã®ææ¡ˆã‚’æ¡ç”¨ã™ã‚‹å‰ã®ãƒã‚§ãƒƒã‚¯âœ…

* `0` / `""` / `false` ã®æ„å‘³ãŒæ½°ã‚Œã¦ãªã„ï¼ŸğŸ”¢ğŸ«§
* â€œç„¡ã„â€ã‚’ `throw` ã«ã™ã¹ãä»•æ§˜ã˜ã‚ƒãªã„ï¼ŸğŸš¨
* `?.` ã®çµæœãŒ `undefined` ã«ãªã£ã¦ã€ãã®å¾Œã§è½ã¡ãªã„ï¼Ÿï¼ˆ`toUpperCase()` ã¨ã‹ï¼‰ğŸ’¥
* å‹ãŒã¡ã‚ƒã‚“ã¨çµã‚Œã¦ã‚‹ï¼Ÿï¼ˆ`if (x == null) return;` ã®å¾Œã¯ `x` ãŒénullï¼‰ğŸ§·âœ¨

---

## ã¾ã¨ã‚ğŸ§âœ¨

* **è½ã¡ãªã„åŸºæœ¬å½¢**ã¯ `?.` ï¼‹ `??` ï¼‹ ã‚¬ãƒ¼ãƒ‰ç¯€ğŸš¦ğŸ›Ÿ
* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ã™ã‚‹ã‹ã€æ­¢ã‚ã‚‹ã‹ã€ã‚¨ãƒ©ãƒ¼ã«ã™ã‚‹ã‹ã‚’**å…ˆã«æ±ºã‚ã‚‹**ã¨è¿·ã‚ãªã„ğŸ§­
* `||` ã¯ä¾¿åˆ©ã ã‘ã© â€œ0/ç©ºæ–‡å­—â€ ã‚’æ½°ã™ã®ã§ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæˆ¦ç•¥ã¯ `??` ãŒå®‰å¿ƒğŸ«¶([MDN Web Docs][3])

[1]: https://www.typescriptlang.org/download/?utm_source=chatgpt.com "How to set up TypeScript"
[2]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining?utm_source=chatgpt.com "Optional chaining (?.) - JavaScript - MDN Web Docs - Mozilla"
[3]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing?utm_source=chatgpt.com "Nullish coalescing operator (??) - JavaScript - MDN Web Docs"
[4]: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_assignment?utm_source=chatgpt.com "Nullish coalescing assignment (??=) - JavaScript | MDN"
[5]: https://www.typescriptlang.org/tsconfig/?utm_source=chatgpt.com "TSConfig Reference - Docs on every TSConfig option"
