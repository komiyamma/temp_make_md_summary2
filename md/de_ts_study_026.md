# ç¬¬26ç«  ãƒ†ã‚¹ãƒˆï¼šãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆãŒå‡ºãŸã‹ï¼Ÿï¼‰ğŸ§ªğŸ’–

## ã“ã®ç« ã®ã‚´ãƒ¼ãƒ«ğŸ¯âœ¨

ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ã€Œå˜ä½“ã€ã§ãƒ†ã‚¹ãƒˆã—ã¦ã€æ¬¡ã®3ç‚¹ã‚’è‡ªä¿¡ã‚’æŒã£ã¦ç¢ºèªã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ğŸ˜ŠğŸŒ¸

* âœ… å…¥åŠ›ï¼ˆãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—ï¼‰ã§ã€çŠ¶æ…‹ãŒæ­£ã—ãå¤‰ã‚ã£ãŸï¼Ÿ
* âœ… ãã®çµæœã¨ã—ã¦ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆãŒ**å‡ºãŸ**ï¼Ÿ
* âœ… ã‚¤ãƒ™ãƒ³ãƒˆã®ä¸­èº«ï¼ˆpayloadï¼‰ãŒ**å¿…è¦æœ€å°é™**ã§æ­£ã—ã„ï¼Ÿ

---

## ã¾ãšçµè«–ï¼šãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆã¯ã€Œå…¥åŠ› â†’ çŠ¶æ…‹ â†’ ã‚¤ãƒ™ãƒ³ãƒˆã€ğŸ§ â¡ï¸ğŸ“¦â¡ï¸ğŸ“£

ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ãƒ†ã‚¹ãƒˆã¯ã€å¤–éƒ¨I/Oï¼ˆDBãƒ»HTTPãƒ»ãƒ¡ãƒ¼ãƒ«é€ä¿¡ãªã©ï¼‰ã‚’ä¸€åˆ‡è§¦ã‚‰ãšã«ã€

1. **ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã¶**
2. **çŠ¶æ…‹ãŒå¤‰ã‚ã£ãŸã‹è¦‹ã‚‹**
3. **ã‚¤ãƒ™ãƒ³ãƒˆãŒæºœã¾ã£ãŸã‹è¦‹ã‚‹**

ã“ã‚Œã ã‘ã§OKã§ã™ğŸ’ªâœ¨
ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã®è¨­è¨ˆã£ã¦ã€Œå¾Œã‹ã‚‰æ©Ÿèƒ½è¿½åŠ ãŒãƒ©ã‚¯ã€ãªã‚“ã ã‘ã©ã€ãƒ†ã‚¹ãƒˆãŒã‚ã‚‹ã¨ãã®å®‰å¿ƒæ„ŸãŒçˆ†å¢—ã—ã¾ã™ğŸ˜‡ğŸ’•

---

## 2026å¹´ã®ãƒ†ã‚¹ãƒˆç’°å¢ƒï¼šVitestã§ã‚µã‚¯ãƒƒã¨ã„ã“ã†âš¡ğŸ§ª

ã“ã®ç« ã§ã¯ **Vitest** ã‚’ä½¿ã„ã¾ã™ğŸ˜Š
ç†ç”±ã¯ã‚·ãƒ³ãƒ—ãƒ«ã§ã€Jestç³»ã®æ›¸ãå‘³ã«ã‹ãªã‚Šäº’æ›ãŒã‚ã‚Šã¤ã¤ã€ä»Šã©ãã®TS/ESMã§ã‚¹ãƒ ãƒ¼ã‚ºã«å‹•ã‹ã—ã‚„ã™ã„ã‹ã‚‰ã§ã™âœ¨ï¼ˆViteã‚’ä½¿ã£ã¦ãªãã¦ã‚‚é¸æŠè‚¢ã«ãªã‚‹ã‚ˆï¼‰([Vitest][1])

ã•ã‚‰ã«ã€ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚‚æ¨™æº–ãƒ«ãƒ¼ãƒˆã§æ‰±ãˆã¾ã™ğŸ“ˆ
Vitestã¯ **v8 / istanbul** ã®ã‚«ãƒãƒ¬ãƒƒã‚¸åé›†ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¦ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯v8ã§ã™ğŸ§©([Vitest][2])

ã¤ã„ã§ã«ã€Node.js å´ã‚‚ 2026å¹´1æœˆæ™‚ç‚¹ã§ **v24ãŒActive LTS** ã¨ã—ã¦æ›´æ–°ã•ã‚Œã¦ã„ã¾ã™ğŸ›¡ï¸([Node.js][3])
ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ›´æ–°ã‚‚å®šæœŸçš„ã«å‡ºã‚‹ã®ã§ã€LTSè¿½å¾“ãŒå®‰å¿ƒã ã‚ˆã€œğŸ˜Œï¼‰

---

## æœ€å°ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆVitest + TSï¼‰ğŸ§°âœ¨

### 1) ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ğŸ“¦

```powershell
npm init -y
npm i -D typescript vitest
npm i -D @vitest/coverage-v8
```

`@vitest/coverage-v8` ã¯ã‚«ãƒãƒ¬ãƒƒã‚¸ç”¨ï¼ˆå¿…è¦ã«ãªã£ãŸã‚‰ã§OKã ã‘ã©ã€å…¥ã‚Œã¨ãã¨ä¾¿åˆ©ï¼‰ğŸ§¡([Vitest][2])

### 2) package.json ã® scripts ğŸƒâ€â™€ï¸ğŸ’¨

```json
{
  "scripts": {
    "test": "vitest",
    "test:run": "vitest run",
    "coverage": "vitest run --coverage"
  }
}
```

`vitest run --coverage` ã®å½¢ã¯å…¬å¼ã‚¬ã‚¤ãƒ‰ã§ã‚‚ç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã™ğŸ“ˆ([Vitest][4])

### 3) vitest.config.tsï¼ˆViteç„¡ã—æ§‹æˆã§ã‚‚OKï¼‰ğŸ§©

Vitestã®è¨­å®šã¯ `vitest/config` ã‹ã‚‰ `defineConfig` ã‚’importã™ã‚Œã°OKã§ã™âœ¨([Vitest][5])

```ts
// vitest.config.ts
import { defineConfig } from "vitest/config";

export default defineConfig({
  test: {
    environment: "node",
    coverage: {
      provider: "v8"
    }
  }
});
```

ã‚«ãƒãƒ¬ãƒƒã‚¸ã® provider æŒ‡å®šã¯å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã©ãŠã‚ŠğŸ§¡([Vitest][2])

### 4) tsconfig.jsonï¼ˆæœ€å°ï¼‰ğŸ”·

```json
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "ESNext",
    "moduleResolution": "Bundler",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true
  }
}
```

---

## ãƒ‰ãƒ¡ã‚¤ãƒ³å®Ÿè£…ï¼šã‚¤ãƒ™ãƒ³ãƒˆãŒã€Œæºœã¾ã‚‹ã€é›†ç´„ã‚’ä½œã‚ã†ğŸ«™ğŸ›ï¸

ã“ã“ã‹ã‚‰ã€Œæ³¨æ–‡ï¼ˆOrderï¼‰ã€ã‚’ä¾‹ã«ã—ã¾ã™ğŸ›’âœ¨
æ”¯æ‰•ã„ãŒæˆåŠŸã—ãŸã‚‰ã€`OrderPaid` ã‚¤ãƒ™ãƒ³ãƒˆãŒå‡ºã‚‹æ„Ÿã˜ã­ğŸ’³ğŸ‰

### ãƒ•ã‚©ãƒ«ãƒ€ä¾‹ğŸ“

* `src/domain/` â€¦ ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆä»Šå›ã“ã“ã ã‘ãƒ†ã‚¹ãƒˆã™ã‚‹ï¼ï¼‰
* `src/domain/*.test.ts` â€¦ ãƒ‰ãƒ¡ã‚¤ãƒ³ã®å˜ä½“ãƒ†ã‚¹ãƒˆ

---

## å®Ÿè£…ï¼ˆæœ€å°ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ + ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒƒãƒ•ã‚¡ï¼‰ğŸ§©ğŸ“¦

### 1) ã‚¤ãƒ™ãƒ³ãƒˆå‹ & ä¾å­˜ï¼ˆClock / IdGeneratorï¼‰â°ğŸ†”

ãƒ†ã‚¹ãƒˆã‚’å®‰å®šã•ã›ã‚‹ã‚³ãƒ„ã¯ã€Œæ™‚é–“ã€ã¨ã€ŒIDã€ã‚’å›ºå®šã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ğŸ˜Š
`new Date()` ã¨ `randomUUID()` ã‚’ãã®ã¾ã¾ä½¿ã†ã¨ã€ãƒ†ã‚¹ãƒˆãŒæ¯å›é•ã†å€¤ã«ãªã£ã¦è¾›ã„ã®â€¦ğŸ¥²

```ts
// src/domain/events.ts
export type DomainEvent<TType extends string, TPayload> = Readonly<{
  eventId: string;
  type: TType;
  occurredAt: Date;
  aggregateId: string;
  payload: TPayload;
}>;

export type Clock = { now(): Date };
export type IdGenerator = { newId(): string };

export const systemClock: Clock = {
  now: () => new Date()
};

// Node.jsã®crypto.randomUUID()ç­‰ã«ç¹‹ãæƒ³å®šï¼ˆã“ã“ã¯ãƒ‰ãƒ¡ã‚¤ãƒ³å¤–ã§å·®ã—æ›¿ãˆOKï¼‰
export const randomId: IdGenerator = {
  newId: () => crypto.randomUUID()
};

export abstract class AggregateRoot {
  private _events: DomainEvent<string, unknown>[] = [];

  protected addEvent(e: DomainEvent<string, unknown>): void {
    this._events.push(e);
  }

  pullEvents(): DomainEvent<string, unknown>[] {
    const copied = [...this._events];
    this._events = [];
    return copied;
  }
}
```

---

### 2) ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ï¼ˆä¾‹ï¼šå†æ”¯æ‰•ã„ç¦æ­¢ï¼‰ğŸš«ğŸ’³

```ts
// src/domain/errors.ts
export class AlreadyPaidError extends Error {
  constructor() {
    super("ã™ã§ã«æ”¯æ‰•ã„æ¸ˆã¿ã§ã™");
    this.name = "AlreadyPaidError";
  }
}

export class InvalidMoneyError extends Error {
  constructor() {
    super("é‡‘é¡ãŒä¸æ­£ã§ã™");
    this.name = "InvalidMoneyError";
  }
}
```

---

### 3) Order é›†ç´„ï¼šæ”¯æ‰•ã„ã§çŠ¶æ…‹å¤‰æ›´ + ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«ğŸ‰ğŸ“£

```ts
// src/domain/order.ts
import { AggregateRoot, Clock, DomainEvent, IdGenerator, randomId, systemClock } from "./events";
import { AlreadyPaidError, InvalidMoneyError } from "./errors";

export type OrderStatus = "Created" | "Paid";

export type OrderPaid = DomainEvent<"OrderPaid", Readonly<{
  paymentId: string;
  paidAmount: number;
}>>;

export class Order extends AggregateRoot {
  private constructor(
    private readonly id: string,
    private status: OrderStatus,
    private readonly totalAmount: number,
    private readonly clock: Clock,
    private readonly ids: IdGenerator
  ) {
    super();
    if (totalAmount < 0) throw new InvalidMoneyError();
  }

  static create(id: string, totalAmount: number, deps?: { clock?: Clock; ids?: IdGenerator }) {
    return new Order(
      id,
      "Created",
      totalAmount,
      deps?.clock ?? systemClock,
      deps?.ids ?? randomId
    );
  }

  getId() {
    return this.id;
  }

  getStatus() {
    return this.status;
  }

  pay(paymentId: string): void {
    if (this.status === "Paid") throw new AlreadyPaidError();

    // çŠ¶æ…‹å¤‰æ›´ï¼ˆäº‹å®ŸãŒèµ·ããŸï¼ï¼‰
    this.status = "Paid";

    // ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œï¼ˆéå»å½¢ã®äº‹å®Ÿï¼‰
    const event: OrderPaid = {
      eventId: this.ids.newId(),
      type: "OrderPaid",
      occurredAt: this.clock.now(),
      aggregateId: this.id,
      payload: {
        paymentId,
        paidAmount: this.totalAmount
      }
    };

    this.addEvent(event);
  }
}
```

---

## ãƒ†ã‚¹ãƒˆï¼šã‚¤ãƒ™ãƒ³ãƒˆãŒã€Œå‡ºãŸã‹ï¼Ÿã€ã‚’ç¢ºèªã—ã‚ˆã†ğŸ§ªğŸ’–

### ãƒ†ã‚¹ãƒˆã®åŸºæœ¬å½¢ï¼ˆAAAï¼‰ğŸ§

* Arrangeï¼šæº–å‚™
* Actï¼šå®Ÿè¡Œ
* Assertï¼šæ¤œè¨¼

ã“ã®ç« ã§ã¯ **ã€ŒçŠ¶æ…‹ã€+ã€Œã‚¤ãƒ™ãƒ³ãƒˆã€** ã®2ç‚¹ã‚’è¦‹ã‚‹ã‚ˆğŸ‘€âœ¨

---

### 1) æ­£å¸¸ç³»ï¼šæ”¯æ‰•ã„ã§ Paid ã«ãªã£ã¦ã€OrderPaid ãŒ1å€‹å‡ºã‚‹âœ…ğŸ‰

```ts
// src/domain/order.test.ts
import { describe, it, expect } from "vitest";
import { Order } from "./order";
import type { Clock, IdGenerator } from "./events";

class FixedClock implements Clock {
  constructor(private readonly fixed: Date) {}
  now() { return this.fixed; }
}

class FixedId implements IdGenerator {
  constructor(private readonly fixed: string) {}
  newId() { return this.fixed; }
}

describe("Orderï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ï¼‰", () => {
  it("æ”¯æ‰•ã„æˆåŠŸã§ã€çŠ¶æ…‹ãŒPaidã«ãªã‚Šã€OrderPaidã‚¤ãƒ™ãƒ³ãƒˆãŒå‡ºã‚‹", () => {
    // Arrange
    const clock = new FixedClock(new Date("2026-01-01T00:00:00.000Z"));
    const ids = new FixedId("evt-001");
    const order = Order.create("order-001", 1200, { clock, ids });

    // Act
    order.pay("pay-999");
    const events = order.pullEvents();

    // Assertï¼ˆçŠ¶æ…‹ï¼‰
    expect(order.getStatus()).toBe("Paid");

    // Assertï¼ˆã‚¤ãƒ™ãƒ³ãƒˆï¼‰
    expect(events).toHaveLength(1);
    expect(events[0]).toMatchObject({
      eventId: "evt-001",
      type: "OrderPaid",
      aggregateId: "order-001",
      payload: {
        paymentId: "pay-999",
        paidAmount: 1200
      }
    });

    // Dateã¯å®Œå…¨ä¸€è‡´ã§è¦‹ã¦ã‚‚OKï¼ˆå›ºå®šã—ã¦ã‚‹ã‹ã‚‰ï¼‰
    expect(events[0].occurredAt.toISOString()).toBe("2026-01-01T00:00:00.000Z");
  });
});
```

---

### 2) é‡è¦ï¼šã‚¤ãƒ™ãƒ³ãƒˆã¯ pull ã—ãŸã‚‰ç©ºã«ãªã‚‹ğŸ«™â¡ï¸ğŸ«§

ã€ŒåŒã˜ã‚¤ãƒ™ãƒ³ãƒˆã‚’2å›å‡¦ç†ã€ã—ãªã„ãŸã‚ã«ã€`pullEvents()` ã¯å–ã‚Šå‡ºã—ãŸã‚‰ç©ºã«ãªã‚‹ã®ãŒä¾¿åˆ©ã§ã™ğŸ˜Š

```ts
import { describe, it, expect } from "vitest";
import { Order } from "./order";

describe("ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒƒãƒ•ã‚¡", () => {
  it("pullEvents()ã™ã‚‹ã¨ã€æ¬¡ã¯ç©ºã«ãªã‚‹", () => {
    const order = Order.create("order-002", 500);
    order.pay("pay-1");

    const first = order.pullEvents();
    const second = order.pullEvents();

    expect(first).toHaveLength(1);
    expect(second).toHaveLength(0);
  });
});
```

---

### 3) æ¼”ç¿’ã®é¡Œæï¼šæ”¯æ‰•ã„æ¸ˆã¿ã¯å†æ”¯æ‰•ã„ä¸å¯ğŸ’³âŒ

ã“ã“ã€è¶…å¤§äº‹ğŸ¥¹âœ¨
ã€Œä¸å¤‰æ¡ä»¶ï¼ˆãƒ«ãƒ¼ãƒ«ï¼‰ã€ã¯ãƒ†ã‚¹ãƒˆã§å®ˆã‚‹ã¨æœ€å¼·ã«ãªã‚Šã¾ã™ğŸ”’âœ…

```ts
import { describe, it, expect } from "vitest";
import { Order } from "./order";
import { AlreadyPaidError } from "./errors";

describe("ä¸å¤‰æ¡ä»¶", () => {
  it("æ”¯æ‰•ã„æ¸ˆã¿ã®æ³¨æ–‡ã¯å†æ”¯æ‰•ã„ã§ããªã„ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆã‚‚å¢—ãˆãªã„ï¼‰", () => {
    const order = Order.create("order-003", 800);

    order.pay("pay-1");
    order.pullEvents(); // 1å›ç›®ã®ã‚¤ãƒ™ãƒ³ãƒˆã¯å‡¦ç†æ¸ˆã¿ã®æƒ³å®šã§æ¨ã¦ã‚‹

    expect(() => order.pay("pay-2")).toThrow(AlreadyPaidError);

    const events = order.pullEvents();
    expect(events).toHaveLength(0);
    expect(order.getStatus()).toBe("Paid");
  });
});
```

---

## ä¹±æ•°ãƒ»æ—¥æ™‚ã®å›ºå®šï¼šVitestã§ã‚‚ã§ãã‚‹ï¼ˆã§ã‚‚ãƒ‰ãƒ¡ã‚¤ãƒ³å´ã§å›ºå®šã§ãã‚‹æ–¹ãŒå¥½ãï¼‰â°ğŸ§Š

Vitestã«ã¯ `vi.setSystemTime` ã¿ãŸã„ãªä»•çµ„ã¿ã‚‚ã‚ã‚Šã¾ã™ğŸ˜Š([Vitest][6])
ãŸã ã—ã€Œãƒ‰ãƒ¡ã‚¤ãƒ³ãŒ Date ã«ç›´æ¥ä¾å­˜ã€ã™ã‚‹ã¨ã€å°†æ¥ã¤ã‚‰ããªã‚ŠãŒã¡â€¦ğŸ¥²

ãªã®ã§ã“ã®æ•™æã§ã¯ã€**Clock/IdGeneratorã‚’æ³¨å…¥**ã™ã‚‹å½¢ã‚’æ¨ã—ã¾ã™ğŸ’¡
ï¼ˆãƒ†ã‚¹ãƒˆãŒå®‰å®šï¼†èª­ã¿ã‚„ã™ã„ï¼†è¨­è¨ˆã‚‚ã‚­ãƒ¬ã‚¤âœ¨ï¼‰

---

## ã‚ˆãã‚ã‚‹å¤±æ•—ã‚ã‚‹ã‚ã‚‹ğŸ˜µâ€ğŸ’«ğŸŒ€ï¼ˆå…ˆã«æ½°ãï¼ï¼‰

### âŒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã®å˜ä½“ãƒ†ã‚¹ãƒˆãªã®ã«ã€DBã‚„HTTPã‚’è§¦ã£ã¡ã‚ƒã†

â†’ ãã‚Œã¯ **ã‚¢ãƒ—ãƒªå±¤/ã‚¤ãƒ³ãƒ•ãƒ©å±¤ã®ãƒ†ã‚¹ãƒˆ** ã§ã‚„ã‚ã†ã­ï¼ˆã“ã®ç« ã˜ã‚ƒãªã„ï¼‰ğŸ™…â€â™€ï¸ğŸ’¦

### âŒ 1ãƒ†ã‚¹ãƒˆã§æ¤œè¨¼ã—ã™ãã‚‹

â†’ ã€ŒçŠ¶æ…‹ã€ã¨ã€Œã‚¤ãƒ™ãƒ³ãƒˆã€ã ã‘ã«é›†ä¸­ã™ã‚‹ã¨ã‚¹ãƒƒã‚­ãƒªã™ã‚‹ã‚ˆğŸ°âœ¨

### âŒ ã‚¤ãƒ™ãƒ³ãƒˆpayloadã«â€œãªã‚“ã§ã‚‚â€å…¥ã‚Œã¦ã—ã¾ã†

â†’ ãƒ†ã‚¹ãƒˆãŒé‡ããªã‚‹ï¼†ä¾å­˜ãŒå¢—ãˆã‚‹ğŸ’ğŸ’¥
å¿…è¦æœ€å°é™ã«ã—ã¦ã€ã€Œè¶³ã‚Šãªã„ã‚‚ã®ã¯å‚ç…§ã§å–ã‚‹ã€ãŒåŸºæœ¬ğŸ¥ºâœ¨

---

## æ¼”ç¿’ğŸ“ğŸ’–ï¼ˆæ‰‹ã‚’å‹•ã‹ã™ã¨ä¸€æ°—ã«ç†è§£ãŒé€²ã‚€ã‚ˆï¼ï¼‰

### æ¼”ç¿’1ï¼šãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’å¢—ã‚„ãã†ğŸ“Œ

æ¬¡ã®3ã¤ã‚’ãƒ†ã‚¹ãƒˆã«ã—ã¦ã¿ã¦ã­ğŸ˜Š

* `totalAmount` ãŒãƒã‚¤ãƒŠã‚¹ãªã‚‰ç”Ÿæˆã§ããªã„ï¼ˆä¾‹å¤–ï¼‰ğŸ’¸âŒ
* `pay("")` ã¿ãŸã„ãªä¸æ­£ãªæ”¯æ‰•ã„IDã‚’å¼¾ããƒ«ãƒ¼ãƒ«ã‚’è¿½åŠ ã—ã¦ã€ãƒ†ã‚¹ãƒˆã™ã‚‹ğŸ§¾
* ã‚¤ãƒ™ãƒ³ãƒˆãŒ2å›å‡ºãªã„ã“ã¨ã‚’ç¢ºèªã™ã‚‹ï¼ˆpullå¾Œã¯ç©ºï¼‰ğŸ«§

### æ¼”ç¿’2ï¼šã‚¤ãƒ™ãƒ³ãƒˆã®ä¸­èº«ã‚’ã€Œæœ€å°ã€ã«æ•´ãˆã‚‹ğŸ’âœ‚ï¸

`OrderPaid` ã® payload ã«ã€Œæ³¨æ–‡ã®å…¨æ˜ç´°ã€ã‚’å…¥ã‚ŒãŸããªã£ãŸã‚‰â€¦
ãã‚Œæœ¬å½“ã«å¿…è¦ï¼Ÿã‚’è€ƒãˆã¦ã€æœ€å°æ¡ˆã«ç›´ã—ã¦ã¿ã‚ˆã†ğŸ˜Œâœ¨

---

## ğŸ¤– AIæ´»ç”¨ï¼ˆCopilot / Codexï¼‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹ğŸ’¬âœ¨

ã‚³ãƒ”ãƒšã—ã¦ä½¿ã£ã¦OKã ã‚ˆã€œğŸ˜†ğŸ’•

* ã€ŒOrderã®`pay()`ã®ä¸å¤‰æ¡ä»¶ï¼ˆå†æ”¯æ‰•ã„ç¦æ­¢ï¼‰ã‚’ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã¨ã—ã¦åˆ—æŒ™ã—ã¦ã€‚æ­£å¸¸ç³»/ç•°å¸¸ç³»ã§åˆ†ã‘ã¦ã­ã€
* ã€Œã“ã®ãƒ†ã‚¹ãƒˆã€è¦‹è½ã¨ã—ã¦ã‚‹å¢ƒç•Œå€¤ã‚ã‚‹ï¼Ÿï¼ˆä¾‹ï¼šé‡‘é¡0ã€paymentIdã®ç©ºæ–‡å­—ã€é€£ç¶šå‘¼ã³å‡ºã—ï¼‰ã€
* ã€Œ`toMatchObject` ã‚’ä½¿ã£ãŸèª­ã¿ã‚„ã™ã„assertã«ç›´ã—ã¦ã€
* ã€Œãƒ†ã‚¹ãƒˆåã‚’â€œä»•æ§˜ãŒèª­ã‚ã‚‹æ—¥æœ¬èªâ€ã«æ•´ãˆã¦ã€`it()`ã®æ–‡ã‚’æ”¹å–„ã—ã¦ã€

---

## ã¾ã¨ã‚ğŸ€âœ¨

ãƒ‰ãƒ¡ã‚¤ãƒ³ã®å˜ä½“ãƒ†ã‚¹ãƒˆã¯ã“ã‚Œã ã‘ã§OKã§ã—ãŸğŸ˜ŠğŸ’–

* ğŸ§  å…¥åŠ› â†’ âœ… çŠ¶æ…‹ â†’ ğŸ“£ ã‚¤ãƒ™ãƒ³ãƒˆ
* ğŸ§Š Clock/Idã‚’å›ºå®šã—ã¦ãƒ†ã‚¹ãƒˆã‚’å®‰å®šã•ã›ã‚‹
* ğŸ«™ `pullEvents()` ã§ â€œå–ã‚Šå‡ºã—ãŸã‚‰ç©ºâ€ ã«ã—ã¦äºŒé‡å‡¦ç†ã‚’é˜²ã

æ¬¡ã®ç« ã§ã¯ã€ã“ã“ã§å‡ºãŸã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ã‘å–ã‚‹å´ï¼ˆãƒãƒ³ãƒ‰ãƒ©ï¼‰ã‚’ã€Œå‰¯ä½œç”¨è¾¼ã¿ã§å®‰å…¨ã«ãƒ†ã‚¹ãƒˆã€ã—ã¦ã„ãã¾ã™ğŸ“ğŸ§ª

[1]: https://vitest.dev/guide/comparisons?utm_source=chatgpt.com "Comparisons with Other Test Runners | Guide"
[2]: https://vitest.dev/guide/coverage.html?utm_source=chatgpt.com "Coverage | Guide"
[3]: https://nodejs.org/en/about/previous-releases?utm_source=chatgpt.com "Node.js Releases"
[4]: https://vitest.dev/guide/features?utm_source=chatgpt.com "Features | Guide"
[5]: https://vitest.dev/config/?utm_source=chatgpt.com "Configuring Vitest"
[6]: https://vitest.dev/guide/mocking?utm_source=chatgpt.com "Mocking | Guide"
