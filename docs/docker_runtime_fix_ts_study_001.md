# 第01章：ランタイム固定って結局なに？🤔🔒

この章は「**なんで“閉じ込め”が必要なの？**」を、イメージできるようになる回だよ📦✨
結論から言うと、ランタイム固定は **“プロジェクト専用の実行環境（Node/TSなど）を、毎回まったく同じ形で再生できるようにする”** ってこと！🔁✅

---

## 1) まずは超ざっくり定義🧠✨

## ✅ ランタイム固定 = 「Node（＋周辺）をプロジェクト側に持たせる」こと

* 今日はNode v25で動いた
* 明日、別PCのNode v24で動かない
* 半年後、あなたのPCが新しくなって動かない

…みたいな **“PC依存ガチャ”** を終わらせるのが目的🎰💥

そのためにやるのが、いわゆる **“閉じ込め”**（コンテナ化）🐳🧊
コンテナは「隔離されたプロセス」で、動作に必要なファイルをまとめて持てるよ、という考え方だよ。([Docker Documentation][1])
そして、その環境セットが **コンテナイメージ**（設計図＋材料全部入り）って感じ！([Docker Documentation][2])

---

## 2) 固定しないと起きる“あるある事故”💣😇

ここ、めちゃ大事。**固定の価値は「事故の痛み」を想像すると一瞬で腹落ち**するよ😅

## 事故A：Nodeの版が違って動かない🟢↔️🟥

例えばこんなの👇

* 新しめのNodeだと動くけど、古いNodeだと構文や挙動が合わなくて落ちる
* 逆に、最新Nodeに上げたら依存ライブラリが追いついてなくて落ちる
* ESM/CJSまわりの差で `import` がコケる（第24章で詳しくやるやつ！）

つまり **「コードが悪いんじゃなく、環境が違うだけ」** で死ぬ…👻

## 事故B：依存関係が“いつの間にか”変わる📦🌀

`npm install` は状況によって解決される依存が変わることがあるから、同じ手順でも結果がズレることがあるのが怖いところ😵‍💫
そこで **lockfile** と **`npm ci`** が出てくる（これは後の章で主役！）
`npm ci` は lockfile とズレてたらエラーで止まり、`node_modules` も消してクリーンに入れ直す仕様だよ。([docs.npmjs.com][3])

## 事故C：「自分のPCでは動く」が発生する（最悪）💀💬

いわゆる “Works on my machine” 問題😇

* チームメンバーやCIで落ちる
* 未来の自分が再現できない
* 直すのに丸1日溶ける🫠

---

## 3) 固定すると何が手に入る？🎁✨

固定のゴールはシンプル！

## ✅ 再現性（Reproducibility）🔁✅

* **同じ手順**で
* **同じ結果**になる
* **環境差が原因のバグ**が激減する

さらに嬉しい副作用👇

* バグ報告が「再現手順が明確」になる🧾✨
* CIが安定する🤖✅
* “半年後の自分” が助かる（ガチで助かる）🕰️🙏

---

## 4) 2026年のNode事情を“超ざっくり”押さえる🗓️🟢

ここは最新状態を前提に、**選び方の感覚**だけ入れるよ！

Nodeにはフェーズがあって、ざっくりこう👇

* **Current**：最新メジャー（新機能が来る）
* **Active LTS**：いま一番おすすめになりやすい安定枠
* **Maintenance LTS**：延命枠（更新は続くけど新鮮さは少なめ）

そして **奇数メジャーはLTSにならない**（Currentで終わりがち）ってルールがあるよ。([GitHub][4])

本日時点（2026-02-09）だと、公式のリリース表はこうなってる👇

* v25 = Current
* v24 = Active LTS
* v22 = Maintenance LTS ([nodejs.org][5])

この章では「へぇ〜そんな枠があるんだ」くらいでOK！👌
第2章で「じゃあ何を選ぶ？」をちゃんと決めるよ🎯

---

## 5) “閉じ込め”は1枚岩じゃない🏰🧱

固定って、実はレベルがあるんだよね（第4章の予告！）👀✨

* **① Node本体**（どのバージョンのNodeで動かす？）
* **② パッケージマネージャ**（npm/pnpm/yarn の扱い）
* **③ 依存関係**（lockfileで“中身”固定）

第1章の時点では、まず **①の存在を理解**できれば勝ち🏆

---

## 6) 30秒ミニ体験：「PCのNodeなし」でNodeが動く🐳💨

もしDockerが入ってたら、これだけで“閉じ込め”の感覚がつかめるよ😆✨
（入ってなかったらスルーでOK！次章以降でちゃんと整える）

```bash
docker run --rm node:24 node -v
```

* `node:24` の環境を一瞬で呼び出して
* `node -v` を実行して
* 終わったら消える（`--rm`）🧼

ここで感じてほしいのはこれ👇
**「え、PCのNodeのバージョン関係なくね？」** ってやつ😆🔒

---

## 7) まとめ：この章で持ち帰る“1枚の地図”🗺️✨

## ✅ 今日のゴール（超重要）🎯

* **ランタイム固定 = PC依存ガチャをやめること**🎰❌
* **閉じ込め（コンテナ） = 必要な環境一式を持ち運ぶこと**📦🐳
* **再現性 = 同じ手順で同じ結果**🔁✅

## ✅ 重要ワード（この3つだけ覚えて！）🧠

* 再現性（Reproducibility）
* 環境差（Environment drift）
* 固定（Pinning / Locking）

---

## おまけ：AI（Copilot/Codex）に投げると学習が速い🤖⚡

“理解が曖昧なまま次へ行く”を防ぐ質問テンプレ👇

```text
ランタイム固定（Node/TSの閉じ込め）って何？
「固定しないと起きる事故」を、初心者向けに3つ具体例で説明して。
最後に、1行で要点もまとめて。
```

---

次の第2章では、いよいよ **「2026年の正解っぽいNode選び（なぜLTS？）」** を“迷わない形”にするよ🟢🎯

[1]: https://docs.docker.com/get-started/docker-concepts/the-basics/what-is-a-container/?utm_source=chatgpt.com "What is a container?"
[2]: https://docs.docker.com/get-started/docker-concepts/the-basics/what-is-an-image/?utm_source=chatgpt.com "What is an image? | Docker Docs"
[3]: https://docs.npmjs.com/cli/v9/commands/npm-ci/?utm_source=chatgpt.com "npm-ci"
[4]: https://github.com/nodejs/Release?utm_source=chatgpt.com "Node.js Release Working Group"
[5]: https://nodejs.org/en/about/previous-releases?utm_source=chatgpt.com "Node.js Releases"
