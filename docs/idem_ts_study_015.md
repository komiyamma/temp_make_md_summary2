# ç¬¬15ç« ï¼šåŒæ™‚å®Ÿè¡Œå…¥é–€ï¼šãƒ¬ãƒ¼ã‚¹ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã£ã¦ä½•ï¼ŸğŸğŸ˜µâ€ğŸ’«

## 15.0 ã“ã®ç« ã®ã‚´ãƒ¼ãƒ« ğŸ¯âœ¨

ã“ã®ç« ãŒçµ‚ã‚ã£ãŸã‚‰ã€ã“ã‚ŒãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ğŸ‘‡ğŸ˜Š

* ã€Œãƒ¬ãƒ¼ã‚¹ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ï¼ˆRace Conditionï¼‰ã€ã‚’ä¸€è¨€ã§èª¬æ˜ã§ãã‚‹ ğŸ—£ï¸ğŸ’¡
* â€œåŒæ™‚ã«æ¥ãŸ2ãƒªã‚¯ã‚¨ã‚¹ãƒˆâ€ãŒã€ãªãœå£Šã‚Œã‚‹ã‹ã‚’å›³ã§èª¬æ˜ã§ãã‚‹ ğŸ§©ğŸ–¼ï¸
* TypeScriptã§ã€Œã‚ã–ã¨ãƒ¬ãƒ¼ã‚¹ã‚’èµ·ã“ã™ã€â†’ã€Œç›´ã£ãŸç‰ˆã€ã‚’å‹•ã‹ã›ã‚‹ ğŸ§ªğŸ”§
* å†ªç­‰ã‚­ãƒ¼ãŒã‚ã£ã¦ã‚‚â€œä½œã‚Šæ–¹ãŒé›‘ã ã¨å£Šã‚Œã‚‹â€ã®ãŒè…‘ã«è½ã¡ã‚‹ ğŸ”‘ğŸ˜±

---

## 15.1 ã€ŒåŒæ™‚å®Ÿè¡Œã€ã£ã¦ã€ã©ã†ã„ã†æ„å‘³ï¼ŸğŸ§µğŸ‘€

ã‚µãƒ¼ãƒãƒ¼ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæ¥ã‚‹ã¨ã€ã ã„ãŸã„ã“ã‚“ãªæ„Ÿã˜ã®å‡¦ç†ã«ãªã‚Šã¾ã™ğŸ‘‡ğŸ™‚

1. å—ã‘å–ã‚‹ ğŸ“©
2. DBã‚„ãƒ¡ãƒ¢ãƒªã‚’è¦‹ã‚‹ ğŸ‘€
3. ä½•ã‹æ›´æ–°ã™ã‚‹ âœï¸
4. å¤–éƒ¨APIï¼ˆæ±ºæ¸ˆãªã©ï¼‰ã‚’å‘¼ã¶ ğŸ’³ğŸŒ
5. çµæœã‚’è¿”ã™ ğŸ“¤

ã“ã“ã§ãƒã‚¤ãƒ³ãƒˆï¼âš ï¸
**ã€ŒåŒæ™‚å®Ÿè¡Œã€ï¼ã¾ã£ãŸãåŒã˜ç¬é–“ã«CPUãŒ2ã¤å‹•ã**ã£ã¦æ„å‘³ã ã‘ã˜ã‚ƒãªã„ã§ã™ğŸ™…â€â™€ï¸ğŸ’¦
**â€œå‡¦ç†ãŒé‡ãªã£ã¦é€²ã‚€ï¼ˆã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—ã™ã‚‹ï¼‰â€**ã ã‘ã§ã€æ™®é€šã«äº‹æ•…ã‚Šã¾ã™ğŸ˜‡

ç‰¹ã« `await` ãŒã‚ã‚‹ã¨â€¦

* é€”ä¸­ã§ä¸€ç¬ â€œå¸­ã‚’ç«‹ã¤â€ ğŸª‘â¡ï¸ğŸš¶â€â™€ï¸ï¼ˆä»–ã®å‡¦ç†ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹ï¼‰
* ãã®é–“ã«åˆ¥ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒåŒã˜ãƒ‡ãƒ¼ã‚¿ã‚’è§¦ã‚‹ ğŸ¤ğŸ’¥

ã ã‹ã‚‰ **JavaScript/Nodeã®ä¸–ç•Œã§ã‚‚ãƒ¬ãƒ¼ã‚¹ã¯èµ·ãã¾ã™**ğŸï¸ğŸ’¨

---

## 15.2 ãƒ¬ãƒ¼ã‚¹ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã®æ­£ä½“ ğŸï¸ğŸ’¥

ãƒ¬ãƒ¼ã‚¹ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã‚’è¶…ã–ã£ãã‚Šè¨€ã†ã¨ğŸ‘‡ğŸ˜µâ€ğŸ’«
**ã€Œå‡¦ç†ã®é †ç•ªï¼ˆã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼‰ã—ã ã„ã§çµæœãŒå¤‰ã‚ã£ã¡ã‚ƒã†çŠ¶æ…‹ã€**ã§ã™ğŸ²ğŸ’£

ã‚ˆãã‚ã‚‹ â€œäº‹æ•…ã®å‹â€ ã¯ã“ã‚ŒğŸ‘‡ï¼ˆè¶…é‡è¦ï¼ï¼‰âœ…

### â‘  ãƒã‚§ãƒƒã‚¯ã—ã¦ã‹ã‚‰å®Ÿè¡Œï¼ˆCheck-then-Actï¼‰ğŸ§â¡ï¸ğŸƒâ€â™€ï¸

* ã€Œã¾ã å‡¦ç†ã—ã¦ãªã„ã‚ˆã­ï¼Ÿã€ã‚’ç¢ºèªã—ã¦
* ãã®ã‚ã¨å‡¦ç†ã™ã‚‹
* ã§ã‚‚ã€ãã®é–“ã«åˆ¥ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå‰²ã‚Šè¾¼ã‚€ğŸ˜‡

### â‘¡ èª­ã‚“ã§ã‹ã‚‰è¶³ã™ï¼ˆRead-Modify-Writeï¼‰ğŸ“–â•âœï¸

* å€¤ã‚’èª­ã‚€ï¼ˆåœ¨åº«=1ï¼‰
* æ¸›ã‚‰ã™ï¼ˆ-1ï¼‰
* æ›¸ãï¼ˆåœ¨åº«=0ï¼‰
* ã§ã‚‚2äººãŒåŒæ™‚ã«èª­ã‚€ã¨ã€Œ1ãŒ2å›èª­ã¾ã‚Œã‚‹ã€ğŸ˜±

---

## 15.3 å…¸å‹äº‹æ•…ï¼šå†ªç­‰ã‚­ãƒ¼ãŒã‚ã£ã¦ã‚‚äºŒé‡æ±ºæ¸ˆï¼ï¼ŸğŸ”‘ğŸ’³ğŸ˜±

å†ªç­‰ã‚­ãƒ¼æ–¹å¼ï¼ˆ10ã€œ14ç« ï¼‰ã£ã¦ã€ã ã„ãŸã„ã“ã†ã„ã†ç™ºæƒ³ã§ã—ãŸğŸ‘‡ğŸ™‚

* åŒã˜ã‚­ãƒ¼ãªã‚‰ã€ŒåŒã˜çµæœã‚’è¿”ã™ã€ğŸ“¦ğŸ”
* ã ã‹ã‚‰äºŒé‡å®Ÿè¡Œã‚’é˜²ã’ã‚‹ã¯ãšï¼âœ¨

â€¦ã§ã‚‚ï¼âš ï¸
**â€œåŒæ™‚ã«2ã¤æ¥ãŸâ€å ´åˆã€ä½œã‚ŠãŒç”˜ã„ã¨äºŒé‡å®Ÿè¡ŒãŒèµ·ãã¾ã™**ğŸ˜‡ğŸ’¥
ç†ç”±ã¯ã‚·ãƒ³ãƒ—ãƒ«ã§ğŸ‘‡

* 1ã¤ç›®ï¼šã€Œã¾ã Mapã«ãªã„ã­ã€â†’ æ±ºæ¸ˆã¸ ğŸ’³
* 2ã¤ç›®ï¼šã€Œã¾ã Mapã«ãªã„ã­ã€â†’ æ±ºæ¸ˆã¸ ğŸ’³
* ã©ã£ã¡ã‚‚åŒã˜ã‚­ãƒ¼ãªã®ã«ã€**â€œã¾ã ä¿å­˜ã—ã¦ãªã„ç¬é–“â€ãŒè¢«ã‚‹**ã‚“ã§ã™ğŸ§¨

---

## 15.4 ãƒŸãƒ‹å®Ÿé¨“ï¼šãƒ¬ãƒ¼ã‚¹ã‚’â€œã‚ã–ã¨èµ·ã“ã™â€ğŸ§ªğŸ”¥

### æº–å‚™ï¼ˆWindows / PowerShellï¼‰ğŸªŸâš¡

æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ã§OKã§ã™ğŸ“âœ¨

```powershell
mkdir ch15-race
cd ch15-race
npm init -y
npm i -D typescript @types/node
```

Node.js ã¯æœ€è¿‘ã€**TypeScriptãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.tsï¼‰ã‚’ãã®ã¾ã¾å®Ÿè¡Œã§ãã‚‹**æ©Ÿèƒ½ãŒå…¥ã£ã¦ã„ã¾ã™ï¼ˆå‹ã¯ãƒã‚§ãƒƒã‚¯ã›ãšã€å‹æ³¨é‡ˆã‚’å–ã‚Šé™¤ã„ã¦å‹•ã‹ã™ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰ğŸ“Œâœ¨ ([Node.js][1])
ã‚¨ãƒ‡ã‚£ã‚¿ç”¨ã« `tsconfig.json` ã‚‚ç½®ã„ã¦ãŠãã¨å¿«é©ã§ã™ğŸ˜ŠğŸ§ ï¼ˆæ¨å¥¨è¨­å®šã‚ã‚Šï¼‰ ([Node.js][2])

```powershell
code .
```

`tsconfig.json` ã‚’ä½œæˆğŸ‘‡

```json
{
  "compilerOptions": {
    "noEmit": true,
    "target": "esnext",
    "module": "nodenext",
    "rewriteRelativeImportExtensions": true,
    "erasableSyntaxOnly": true,
    "verbatimModuleSyntax": true
  }
}
```

---

### â‘  ã¾ãšã¯ãƒã‚°ã‚‹ç‰ˆï¼ˆNaiveï¼‰ğŸ˜‡ğŸ’¥

`race-naive.ts` ã‚’ä½œã£ã¦ã€ã“ã‚Œã‚’è²¼ã‚Šã¾ã™ğŸ‘‡ğŸ§ª

```ts
// race-naive.ts
const sleep = (ms: number) => new Promise<void>((r) => setTimeout(r, ms));

let chargeCount = 0;

// ã€Œå†ªç­‰ã‚­ãƒ¼ â†’ ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€ã®ã¤ã‚‚ã‚Šï¼ˆã§ã‚‚ä½œã‚ŠãŒç”˜ã„ä¾‹ï¼‰
const responseCache = new Map<string, string>();

async function confirmPaymentNaive(idempotencyKey: string): Promise<string> {
  // âœ… åŒã˜ã‚­ãƒ¼ãªã‚‰åŒã˜çµæœã‚’è¿”ã—ãŸã„â€¦ï¼
  if (responseCache.has(idempotencyKey)) {
    return responseCache.get(idempotencyKey)!;
  }

  // â— ã“ã“ã§ await ãŒå…¥ã‚‹ï¼ˆå¤–éƒ¨æ±ºæ¸ˆAPIå‘¼ã³å‡ºã—ã®ã¤ã‚‚ã‚Šï¼‰
  await sleep(50);

  // â— å‰¯ä½œç”¨ï¼ˆæ±ºæ¸ˆï¼‰ãŒèµ°ã‚‹
  chargeCount++;
  const res = `OK: charged=${chargeCount}`;

  // âœ… ã“ã‚Œã§æ¬¡ã‹ã‚‰åŒã˜çµæœâ€¦ã®ã¤ã‚‚ã‚Š
  responseCache.set(idempotencyKey, res);
  return res;
}

async function main() {
  const key = "idem-123";

  // ã€ŒåŒã˜ã‚­ãƒ¼ã§åŒæ™‚ã«2å›ã€ğŸ’¥
  const [a, b] = await Promise.all([
    confirmPaymentNaive(key),
    confirmPaymentNaive(key),
  ]);

  console.log("result A:", a);
  console.log("result B:", b);
  console.log("chargeCount:", chargeCount);
  console.log("cache:", responseCache.get(key));
}

main().catch(console.error);
```

å®Ÿè¡ŒğŸ‘‡ğŸš€
ï¼ˆNode v22.18.0ä»¥é™ãªã‚‰ `.ts` ã‚’ãã®ã¾ã¾å®Ÿè¡Œã§ãã¾ã™ï¼‰ ([Node.js][1])
ã‚‚ã—ã†ã¾ãå‹•ã‹ãªã‘ã‚Œã° `--experimental-strip-types` ã§ã‚‚OKã§ã™ ([Node.js][1])

```powershell
node .\race-naive.ts
## ã†ã¾ãã„ã‹ãªã„æ™‚ï¼š
node --experimental-strip-types .\race-naive.ts
```

**èµ·ãã¦ã»ã—ã„ï¼ˆäº‹æ•…ã‚‹ï¼‰çµæœã‚¤ãƒ¡ãƒ¼ã‚¸**ğŸ˜±ğŸ’³

* `chargeCount` ãŒ **2** ã«ãªã‚‹ï¼ˆï¼äºŒé‡æ±ºæ¸ˆã£ã½ã„ï¼ï¼‰
* `result A` ã¨ `result B` ãŒã‚ºãƒ¬ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ï¼ˆã‚¿ã‚¤ãƒŸãƒ³ã‚°æ¬¡ç¬¬ï¼‰ğŸ²

---

### â‘¡ ã©ã‚“ãªé †ç•ªã§å£Šã‚ŒãŸï¼Ÿï¼ˆäº¤äº’å®Ÿè¡Œå›³ï¼‰ğŸ§©ğŸ–¼ï¸

åŒã˜ã‚­ãƒ¼ãªã®ã«äºŒé‡å®Ÿè¡Œã«ãªã‚‹ â€œæœ€æ‚ªã®ä¸¦ã³â€ ã‚’å›³ã«ã™ã‚‹ã¨ã“ã†ğŸ‘‡ğŸ˜µâ€ğŸ’«

* ãƒªã‚¯ã‚¨ã‚¹ãƒˆAï¼š`has(key)` â†’ **false**
* ãƒªã‚¯ã‚¨ã‚¹ãƒˆBï¼š`has(key)` â†’ **false**ï¼ˆAãŒã¾ã ä¿å­˜ã—ã¦ãªã„ï¼‰
* Aï¼šæ±ºæ¸ˆï¼ˆchargeCount++ï¼‰ğŸ’³
* Bï¼šæ±ºæ¸ˆï¼ˆchargeCount++ï¼‰ğŸ’³ğŸ’³
* Aï¼šcacheã«ä¿å­˜
* Bï¼šcacheã«ä¿å­˜ï¼ˆä¸Šæ›¸ãï¼‰ğŸ« 

ã¤ã¾ã‚Šã€**ã€Œãƒã‚§ãƒƒã‚¯ã€ã¨ã€Œä¿å­˜ã€ã®é–“ã« await ãŒã‚ã‚‹**ã¨ã€å‰²ã‚Šè¾¼ã¿æ”¾é¡Œãªã‚“ã§ã™âš”ï¸ğŸ’¥

---

### â‘¢ ã¡ã‚‡ã„æ”¹å–„ï¼šå‡¦ç†ä¸­ã‚’å…±æœ‰ã™ã‚‹ï¼ˆin-flight Promiseï¼‰â³ğŸ¤âœ¨

åŒæ™‚ã«æ¥ãŸ2ã¤ç›®ã¯ã€**1ã¤ç›®ã®å‡¦ç†ãŒçµ‚ã‚ã‚‹ã®ã‚’å¾…ã¤**ã‚ˆã†ã«ã—ã¾ã™ğŸ™‚
ã€Œå‡¦ç†ä¸­ã€ã¨ã„ã†çŠ¶æ…‹ã‚’å…±æœ‰ã™ã‚‹ã ã‘ã§ã€ãƒ¡ãƒ¢ãƒªå†…ãªã‚‰ã‹ãªã‚Šé˜²ã’ã¾ã™âœ…

`race-fixed.ts`ğŸ‘‡

```ts
// race-fixed.ts
const sleep = (ms: number) => new Promise<void>((r) => setTimeout(r, ms));

let chargeCount = 0;

const responseCache = new Map<string, string>();
const inFlight = new Map<string, Promise<string>>();

async function confirmPaymentBetter(idempotencyKey: string): Promise<string> {
  // 1) ã‚‚ã†çµæœãŒã‚ã‚Œã°å³è¿”ã™ âœ…
  const cached = responseCache.get(idempotencyKey);
  if (cached) return cached;

  // 2) ã„ã¾èª°ã‹ãŒå‡¦ç†ä¸­ãªã‚‰ã€ãã‚Œã‚’å¾…ã¤ âœ…
  const running = inFlight.get(idempotencyKey);
  if (running) return running;

  // 3) è‡ªåˆ†ãŒã€Œä»£è¡¨ã§å‡¦ç†ã™ã‚‹ã€Promiseã‚’ç™»éŒ²ã™ã‚‹ âœ…ï¼ˆawaitã‚ˆã‚Šå…ˆã«ï¼ï¼‰
  const p = (async () => {
    try {
      await sleep(50); // å¤–éƒ¨æ±ºæ¸ˆAPIã®ã¤ã‚‚ã‚Š

      chargeCount++;
      const res = `OK: charged=${chargeCount}`;

      responseCache.set(idempotencyKey, res);
      return res;
    } finally {
      inFlight.delete(idempotencyKey);
    }
  })();

  inFlight.set(idempotencyKey, p);
  return p;
}

async function main() {
  const key = "idem-123";

  const [a, b] = await Promise.all([
    confirmPaymentBetter(key),
    confirmPaymentBetter(key),
  ]);

  console.log("result A:", a);
  console.log("result B:", b);
  console.log("chargeCount:", chargeCount);
  console.log("cache:", responseCache.get(key));
}

main().catch(console.error);
```

å®Ÿè¡ŒğŸ‘‡ğŸš€

```powershell
node .\race-fixed.ts
## ã†ã¾ãã„ã‹ãªã„æ™‚ï¼š
node --experimental-strip-types .\race-fixed.ts
```

æœŸå¾…ã™ã‚‹çµæœğŸ‘‡ğŸ˜Šâœ¨

* `chargeCount` ãŒ **1** ã«ãªã‚‹ ğŸ‰
* `result A` ã¨ `result B` ãŒåŒã˜ã«ãªã‚‹ ğŸ”âœ…

---

## 15.5 ãƒ¬ãƒ¼ã‚¹ã‚’è¦‹æŠœãã‚³ãƒ„ ğŸ‘€ğŸ”âœ¨

ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚“ã§ã¦ã€ã“ã‚ŒãŒè¦‹ãˆãŸã‚‰ãƒ¬ãƒ¼ã‚¹ç–‘ã„æ¿ƒåšã§ã™âš ï¸ğŸ˜µâ€ğŸ’«

* `if (ã¾ã ã‚„ã£ã¦ãªã„)` ã®ã‚ã¨ã« `await` ãŒã‚ã‚‹ ğŸ§â¡ï¸â³
* `read â†’ await â†’ write` ã®å½¢ã«ãªã£ã¦ã‚‹ ğŸ“–â¡ï¸â³â¡ï¸âœï¸
* ã€ŒåŒã˜ã‚­ãƒ¼ã¯1å›ã ã‘ã€ã®ã¯ãšãªã®ã«ã€**çŠ¶æ…‹ã‚’ç½®ãã®ãŒé…ã„**ğŸ¢ğŸ’¦
* ãŸã¾ã«ã—ã‹èµ·ããªã„ï¼ˆå†ç¾ã—ã«ãã„ï¼‰ğŸ²ğŸ˜‡

---

## 15.6 ãƒŸãƒ‹æ¼”ç¿’ âœï¸ğŸ“ğŸ’–

### æ¼”ç¿’1ï¼šäº¤äº’å®Ÿè¡Œã‚’åŸ‹ã‚ã‚ˆã†ğŸ§©

æ¬¡ã®ç©ºæ¬„ã‚’åŸ‹ã‚ã¦ã€äºŒé‡æ±ºæ¸ˆã«ãªã‚‹é †ç•ªã‚’å®Œæˆã•ã›ã¦ã­ğŸ™‚

* A: has(key) â†’ (ã€€ã€€ã€€)
* B: has(key) â†’ (ã€€ã€€ã€€)
* A: chargeCount++ â†’ (ã€€ã€€ã€€)
* B: chargeCount++ â†’ (ã€€ã€€ã€€)
* A: cache.set
* B: cache.set

### æ¼”ç¿’2ï¼šã‚ã–ã¨ â€œèµ·ãã‚„ã™ãâ€ ã—ã¦ã¿ã‚ˆã†ğŸ§ª

`race-naive.ts` ã® `sleep(50)` ã‚’ `sleep(200)` ã«ã—ã¦ã€äº‹æ•…ç‡ãŒä¸ŠãŒã‚‹ã‹è¦‹ã¦ã¿ã‚ˆã†ğŸ˜ˆğŸ”¥

### æ¼”ç¿’3ï¼šã‚­ãƒ¼ã‚’å¤‰ãˆãŸã‚‰ã©ã†ãªã‚‹ï¼ŸğŸ”‘ğŸ”

åŒæ™‚ã«æ¥ã‚‹2ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã‚­ãƒ¼ã‚’

* åŒã˜ã‚­ãƒ¼
* é•ã†ã‚­ãƒ¼
  ã§æ¯”ã¹ã¦ã€`chargeCount` ãŒã©ã†å¤‰ã‚ã‚‹ã‹è¦³å¯Ÿã—ã‚ˆã†ğŸ‘€âœ¨

---

## 15.7 AIæ´»ç”¨ã‚³ãƒ¼ãƒŠãƒ¼ ğŸ¤–ğŸ’¡âœ¨

### â‘  ãƒ¬ãƒ¼ã‚¹ã‚’â€œæ–™ç†â€ã§ä¾‹ãˆã¦ğŸ³ğŸ˜‚

ã‚³ãƒ”ãƒšç”¨ğŸ‘‡

```text
ãƒ¬ãƒ¼ã‚¹ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã‚’ã€æ–™ç†ã‚„è²·ã„ç‰©ã®ä¾‹ãˆã§èª¬æ˜ã—ã¦ã€‚
ã€Œãƒã‚§ãƒƒã‚¯ã—ã¦ã‹ã‚‰å®Ÿè¡Œï¼ˆCheck-then-Actï¼‰ã€ãŒå‰²ã‚Šè¾¼ã¾ã‚Œã‚‹æ„Ÿã˜ãŒä¼ã‚ã‚‹ã‚ˆã†ã«ã—ã¦ã€‚
```

### â‘¡ äº¤äº’å®Ÿè¡Œã®â€œæœ€æ‚ªãƒ‘ã‚¿ãƒ¼ãƒ³â€ã‚’ä½œã‚‰ã›ã‚‹ğŸ§©

```text
ã“ã®ã‚³ãƒ¼ãƒ‰ï¼ˆè²¼ã‚Šä»˜ã‘ã‚‹ï¼‰ã§ã€äºŒé‡æ±ºæ¸ˆãŒèµ·ãã‚‹ã€Œå‡¦ç†ã®é †ç•ªï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒªãƒ¼ãƒ–ï¼‰ã€ã‚’
ç•ªå·ä»˜ãã§10ã‚¹ãƒ†ãƒƒãƒ—ä»¥å†…ã«æ›¸ã„ã¦ã€‚
```

### â‘¢ ãƒ†ã‚¹ãƒˆè¦³ç‚¹ã‚’å‡ºã•ã›ã‚‹ğŸ§ªâœ…

```text
ã“ã®å‡¦ç†ã®ãƒ¬ãƒ¼ã‚¹ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã‚’æ¤œå‡ºã™ã‚‹ãƒ†ã‚¹ãƒˆè¦³ç‚¹ã‚’10å€‹å‡ºã—ã¦ã€‚
ã€ŒåŒã˜ã‚­ãƒ¼ã€ã€ŒåŒæ™‚ã€ã€Œé…å»¶ã€ã€Œä¾‹å¤–ã€ã‚‚å«ã‚ã¦ã€‚
```

---

## 15.8 æ¬¡ç« ã¸ã®æ©‹æ¸¡ã— ğŸªœâœ¨

ã“ã®ç« ã§ã‚„ã£ãŸã®ã¯ã€ã€ŒåŒæ™‚ã«æ¥ã‚‹ã¨å£Šã‚Œã‚‹ã€ä½“é¨“ã¨ã€ãƒ¬ãƒ¼ã‚¹ã®è¦‹åˆ†ã‘æ–¹ã§ã—ãŸğŸğŸ™‚
æ¬¡ã¯ã‚‚ã£ã¨å®Ÿå‹™ã£ã½ãğŸ‘‡ã¸é€²ã¿ã¾ã™ğŸ’ª

* **ç¬¬16ç« ï¼šãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„**ã§â€œç‰©ç†çš„ã«äºŒé‡ç™»éŒ²ã§ããªã„â€ä¸–ç•Œã¸ğŸ—„ï¸ğŸ›¡ï¸
* **ç¬¬17ç« ï¼šãƒ­ãƒƒã‚¯/Atomic**ã§â€œå…ˆç€1åã ã‘å®Ÿè¡Œâ€ã‚’å …ãã™ã‚‹ğŸ”’âš¡

ï¼ˆãƒ¡ãƒ¢ãƒªå†…ã§ã®å°æŠ€ã¯åŠ¹ãã‘ã©ã€ãƒ—ãƒ­ã‚»ã‚¹ãŒè¤‡æ•°ã«ãªã‚‹ã¨åˆ¥ã®ä½œæˆ¦ãŒå¿…è¦ã«ãªã£ã¦ãã‚‹ã‚ˆã€œï¼ğŸ˜‡ğŸ§ ï¼‰

[1]: https://nodejs.org/en/learn/typescript/run-natively "Node.js â€” Running TypeScript Natively"
[2]: https://nodejs.org/api/typescript.html "Modules: TypeScript | Node.js v25.5.0 Documentation"

