# ç¬¬27ç« ï¼šnpm scriptsè¨­è¨ˆï¼šã€Œè¦šãˆãªãã¦ã„ã„ã€ã‚³ãƒãƒ³ãƒ‰ä½“ç³»ğŸ§©âœ¨

ã“ã®ç« ã®ã‚´ãƒ¼ãƒ«ã¯ã‚·ãƒ³ãƒ—ãƒ«ğŸ‘‡
**ã€Œæ¯æ—¥ä½¿ã†ã‚³ãƒãƒ³ãƒ‰ã‚’å›ºå®šã—ã¦ã€é•·ã„å‘ªæ–‡ï¼ˆdockerã‚³ãƒãƒ³ãƒ‰ç­‰ï¼‰ã‚’éš ã—ã€è¿·ã„ã‚¼ãƒ­ã«ã™ã‚‹ã€**ã§ã™ğŸ˜ŠğŸ‘

---

## 1) ã¾ãšçŸ¥ã£ã¦ãŠãã¨å¾—ã™ã‚‹ã“ã¨ï¼ˆnpmã®â€œç´ ã®æŒ™å‹•â€ï¼‰ğŸ”

* `npm run` ã¯ã€**package.json ã® scripts ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®å…¥å£**ã§ã™ã€‚ã‚³ãƒãƒ³ãƒ‰åã‚’çœç•¥ã™ã‚‹ã¨ **åˆ©ç”¨å¯èƒ½ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸€è¦§ãŒè¡¨ç¤º**ã•ã‚Œã¾ã™ã€‚([docs.npmjs.com][1])
* Node v24 ç³»ã¯ npm v11 ã‚’åŒæ¢±ã—ã¦ã„ã¦ï¼ˆã¤ã¾ã‚Š npm å´ã‚‚ã‚ã‚Šã¨æ–°ã—ã‚ï¼‰ã€ã€Œnpm scriptsã¯â€œæ¨™æº–ã®é‹ç”¨æ©Ÿæ§‹â€ã€ã¨ã—ã¦ä½¿ã£ã¦OKãªæ™‚ä»£ã§ã™ã€‚([nodejs.org][2])
* `pre<name>` / `post<name>` ã‚’ä½œã‚‹ã¨ã€å¯¾è±¡ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å‰å¾Œã« **è‡ªå‹•ã§èµ°ã‚‹**ä»•çµ„ã¿ãŒã‚ã‚Šã¾ã™ï¼ˆä¾¿åˆ©ã ã‘ã©ã€åˆå¿ƒè€…ã¯äº‹æ•…ã‚Šã‚„ã™ã„ã®ã§ä½¿ã„ã©ã“ã‚ã‚’é¸ã¶ï¼‰([docs.npmjs.com][3])

---

## 2) â€œè¦šãˆãªãã¦ã„ã„ä½“ç³»â€ã®è¨­è¨ˆãƒ«ãƒ¼ãƒ«ï¼ˆè¶…é‡è¦ï¼‰ğŸ§ âœ¨

ã“ã“ã‹ã‚‰ãŒæœ¬é¡Œã§ã™ğŸ’¡
**scriptsã¯ã€Œè¨­è¨ˆã€ã§ã™ã€‚ã‚³ãƒãƒ³ãƒ‰ã‚’å¢—ã‚„ã™ã»ã©è¿·ã†ã®ã§ã€å…¥å£ã‚’çµã‚Šã¾ã™ã€‚**

### ãƒ«ãƒ¼ãƒ«Aï¼šå…¥å£ã¯å›ºå®šã®â€œ5ã€œ8å€‹â€ã«ã™ã‚‹ğŸšª

ã¾ãšã¯ã“ã®ã¸ã‚“ã ã‘ã‚’ã€Œäººé–“ãŒè¦šãˆã‚‹ã‚³ãƒãƒ³ãƒ‰ã€ã«ã—ã¾ã™ğŸ‘‡

* `dev`ï¼ˆé–‹ç™ºã‚’èµ·å‹•ï¼‰
* `test`ï¼ˆãƒ†ã‚¹ãƒˆä¸€ç™ºï¼‰
* `lint`ï¼ˆãƒã‚§ãƒƒã‚¯ï¼‰
* `format`ï¼ˆæ•´å½¢ï¼‰
* `typecheck`ï¼ˆå‹ã ã‘ãƒã‚§ãƒƒã‚¯ï¼‰
* `build`ï¼ˆæœ¬ç•ªãƒ“ãƒ«ãƒ‰ãŒã‚ã‚‹ãªã‚‰ï¼‰
* `start`ï¼ˆæœ¬ç•ªèµ·å‹•ãŒã‚ã‚‹ãªã‚‰ï¼‰
* `ci`ï¼ˆCIã§ã¾ã¨ã‚å®Ÿè¡Œã—ãŸã„ãªã‚‰ï¼‰

å…¥å£ãŒå›ºå®šã ã¨ã€ãƒãƒ¼ãƒ ã§ã‚‚æœªæ¥ã®è‡ªåˆ†ã§ã‚‚è¿·ã„ã¾ã›ã‚“ğŸ˜Š

### ãƒ«ãƒ¼ãƒ«Bï¼šæ´¾ç”Ÿã¯ã€Œã‚³ãƒ­ãƒ³ã€ã§æåˆ†ã‹ã‚ŒğŸŒ¿

è¦šãˆã‚‹ã®ã¯ `dev` ã ã‘ã€‚ç´°ã‹ã„ã®ã¯â€œå¿…è¦ãªäººã ã‘ä½¿ã†â€ã«ã—ã¾ã™ã€‚

* `dev:logs`
* `test:watch`
* `lint:fix`
* `format:check`
* `docker:up` / `docker:down` / `docker:sh` â€¦ã¿ãŸã„ã«ç”¨é€”åˆ¥ã«

### ãƒ«ãƒ¼ãƒ«Cï¼š1è¡Œã§æ›¸ã‘ãªã„ãªã‚‰ã€Œscripts/ ã«é€ƒãŒã™ã€ğŸƒâ€â™‚ï¸ğŸ’¨

package.json ã«é•·ã„ã‚³ãƒãƒ³ãƒ‰ã‚’æ›¸ãå§‹ã‚ã‚‹ã¨ã€ä¿å®ˆåœ°ç„ã«ãªã‚Šã¾ã™ğŸ˜‡
ã‚„ã‚‹ã“ã¨ãŒå¢—ãˆãŸã‚‰ã“ã†ğŸ‘‡

* package.jsonï¼šå…¥å£ã ã‘ï¼ˆçŸ­ã„ï¼‰
* `scripts/*.mjs`ï¼šä¸­èº«ï¼ˆé•·ã„å‡¦ç†ã€åˆ†å²ã€ãƒ­ã‚°æ•´å½¢ãªã©ï¼‰

### ãƒ«ãƒ¼ãƒ«Dï¼šWindowsã®ç½ ã¯æœ€åˆã‹ã‚‰å›é¿ğŸª¤

* ç’°å¢ƒå¤‰æ•°ã®æ›¸ãæ–¹ãŒShellã§å¤‰ã‚ã‚‹å•é¡Œ â†’ `cross-env` ã‚’ä½¿ã†ï¼ˆWindowså¯¾ç­–ã®å®šç•ªï¼‰([npm][4])
* `rm -rf` ã¿ãŸã„ãªUNIXå°‚ç”¨ â†’ `rimraf` ã‹ Nodeã‚¹ã‚¯ãƒªãƒ—ãƒˆã¸
* ä¸¦åˆ—å®Ÿè¡Œã§ `&` ã¨ã‹ã«é ¼ã‚‹ã¨Windowsã®cmd/pwshå·®ã§äº‹æ•…ã‚ŠãŒã¡ â†’ `npm-run-all` / `concurrently` ã‚’ä½¿ã†ã®ãŒç„¡é›£

  * `npm-run-all --parallel` ã¯ Windowsã§ã‚‚å‹•ãå‰æã§ä½œã‚‰ã‚Œã¦ã‚‹ã€ã¨ã„ã†è©±ãŒæ˜è¨˜ã•ã‚Œã¦ã„ã¾ã™ã€‚([GitHub][5])

---

## 3) â€œã“ã®æ•™æã®å…¸å‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆâ€å‘ã‘ scripts ä¾‹ ğŸ§©ï¼ˆã‚³ãƒ”ãƒšOKï¼‰

ãƒã‚¤ãƒ³ãƒˆã¯ã€Œ**dev/test/lint/format ã‚’å›ºå®šåã«ã™ã‚‹**ã€ã¨ã€Œ**dockerã®é•·æ–‡ã‚’éš ã™**ã€ã§ã™ğŸ˜âœ¨

```json
{
  "scripts": {
    "dev": "npm run docker:up",
    "test": "vitest run",
    "test:watch": "vitest",
    "lint": "eslint .",
    "lint:fix": "eslint . --fix",
    "format": "prettier . --write",
    "format:check": "prettier . --check",
    "typecheck": "tsc -p tsconfig.json --noEmit",

    "docker:up": "docker compose up --build",
    "docker:down": "docker compose down",
    "docker:logs": "docker compose logs -f --tail=200",
    "docker:sh": "docker compose exec api sh",
    "docker:ps": "docker compose ps",

    "help": "node scripts/help.mjs"
  }
}
```

> âœ… **è¦šãˆã‚‹ã®ã¯ `npm run dev` ã ã‘**ï¼ˆã‚ã¨ã¯å¿…è¦ã«ãªã£ãŸã‚‰ `npm run` ã§ä¸€è¦§è¦‹ã‚Œã°OKï¼‰([docs.npmjs.com][1])

### ã©ã†ã„ã†æ„å›³ï¼Ÿï¼ˆè¶…ã‹ã‚“ãŸã‚“è§£èª¬ï¼‰ğŸ˜Š

* `dev`ï¼šé–‹ç™ºé–‹å§‹ã®â€œå”¯ä¸€ã®å…¥å£â€ğŸšªâœ¨ï¼ˆä¸­èº«ã¯dockerã«ä¸¸æŠ•ã’ï¼‰
* `test`ï¼šCIã§ã‚‚ãƒ­ãƒ¼ã‚«ãƒ«ã§ã‚‚åŒã˜ã§OKğŸ§ª
* `lint` / `format`ï¼šäº‹æ•…é˜²æ­¢ã¨èª­ã¿ã‚„ã™ã•ğŸ§¹
* `typecheck`ï¼šãƒ†ã‚¹ãƒˆã¨ã¯åˆ¥ã«â€œå‹ã®ä¿è¨¼â€ã ã‘é«˜é€Ÿã«ğŸ”
* `docker:*`ï¼šäººé–“ãŒæ‰“ã¤ã«ã¯é•·ã„ã‚‚ã®ã‚’çŸ­ç¸®ğŸª„
* `help`ï¼šãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç‹¬è‡ªã®â€œä½¿ã„æ–¹â€ã‚’è¡¨ç¤ºï¼ˆå¾Œã§åŠ¹ãï¼ï¼‰

---

## 4) ã€Œhelpã€ã‚³ãƒãƒ³ãƒ‰ã§è¿·å­ã‚¼ãƒ­ã«ã™ã‚‹ğŸ§­âœ¨

`npm run` ã§ã‚‚ä¸€è¦§ã¯å‡ºã¾ã™ãŒã€**ä½•ã‚’ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‹**ã¾ã§ã¯ä¼ã‚ã‚Šã¾ã›ã‚“ã€‚
ãªã®ã§ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå°‚ç”¨ã®èª¬æ˜ã‚’ `npm run help` ã«å…¥ã‚Œã‚‹ã¨å¼·ã„ã§ã™ğŸ˜Š

`./scripts/help.mjs` ã®ä¾‹ğŸ‘‡

```js
const lines = [
  "ğŸ§© ã‚ˆãä½¿ã†ã‚³ãƒãƒ³ãƒ‰",
  "  npm run dev           : é–‹ç™ºã‚’èµ·å‹•ï¼ˆCompose upï¼‰",
  "  npm run test          : ãƒ†ã‚¹ãƒˆä¸€ç™º",
  "  npm run test:watch    : ãƒ†ã‚¹ãƒˆwatch",
  "  npm run lint          : ESLintãƒã‚§ãƒƒã‚¯",
  "  npm run lint:fix      : ESLintè‡ªå‹•ä¿®æ­£",
  "  npm run format        : Prettieræ•´å½¢",
  "  npm run format:check  : Prettieræ•´å½¢ãƒã‚§ãƒƒã‚¯ã ã‘",
  "  npm run typecheck     : å‹ãƒã‚§ãƒƒã‚¯ï¼ˆnoEmitï¼‰",
  "",
  "ğŸ³ Dockerç³»",
  "  npm run docker:logs   : ãƒ­ã‚°è¿½è·¡",
  "  npm run docker:sh     : apiã‚³ãƒ³ãƒ†ãƒŠã«å…¥ã‚‹",
];

console.log(lines.join("\n"));
```

ã“ã‚Œã§æ–°ã—ãå…¥ã£ãŸäººã‚‚ã€æœªæ¥ã®è‡ªåˆ†ã‚‚è¿·ã„ã¾ã›ã‚“ğŸ¥¹âœ¨

---

## 5) ç’°å¢ƒå¤‰æ•°ã‚’scriptsã§ä½¿ã„ãŸã„æ™‚ï¼ˆWindowsã§è©°ã¾ã‚Šã‚„ã™ã„ï¼‰ğŸ’£

ãŸã¨ãˆã°ã€Œãƒ­ã‚°ã‚’å¢—ã‚„ã™ã€ã¿ãŸã„ãªæ™‚ã«ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ã†ã“ã¨ã‚ã‚Šã¾ã™ã‚ˆã­ã€‚

**ãƒ€ãƒ¡ã«ãªã‚ŠãŒã¡ä¾‹ï¼ˆShellå·®ãŒå‡ºã‚‹ï¼‰**ğŸ˜µ

* `NODE_ENV=development node ...` ã¯Windowsã ã¨ãã®ã¾ã¾ã§ã¯å‹•ã‹ãªã„ã“ã¨ãŒå¤šã„

**å®‰å®šè§£ï¼š`cross-env`**âœ…ï¼ˆWindowså¯¾ç­–ã®å®šç•ªï¼‰([npm][4])

```json
{
  "scripts": {
    "dev:debug": "cross-env LOG_LEVEL=debug npm run dev"
  }
}
```

---

## 6) pre/post scripts ã¯â€œåˆå¿ƒè€…ã®ã†ã¡ã¯æ§ãˆã‚â€ãŒæ­£è§£ğŸ˜‡

`prebuild` â†’ `build` â†’ `postbuild` ã¿ãŸã„ã«è‡ªå‹•ã§å‰å¾Œå‡¦ç†ã§ãã¦ä¾¿åˆ©ãªã‚“ã§ã™ãŒã€
ã€Œã„ã¤ä½•ãŒèµ°ã£ã¦ã‚‹ã®ã‹åˆ†ã‹ã‚‰ãªã„ğŸ˜µã€ãŒèµ·ãã‚„ã™ã„ã§ã™ã€‚([docs.npmjs.com][3])

ã•ã‚‰ã« npm ã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã‚‚ã€`preinstall` / `install` ã¯åŸºæœ¬çš„ã«é¿ã‘ã‚‹ã¹ãï¼ˆç‰¹æ®Šäº‹æƒ…ä»¥å¤–ï¼‰ã¨ã„ã†è¶£æ—¨ãŒæ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚([docs.npmjs.com][6])

ãªã®ã§æœ€åˆã¯ã“ã†ã„ã†æ–¹é‡ãŒå®‰å…¨ã§ã™ğŸ‘‡

* âœ… â€œé–‹ç™ºè€…ãŒæ˜ç¤ºçš„ã«å©ãã‚³ãƒãƒ³ãƒ‰â€ã«å¯„ã›ã‚‹ï¼ˆ`npm run build` ã¨ã‹ï¼‰
* âœ… è‡ªå‹•ã§èµ°ã‚‹ç³»ï¼ˆinstall hooksï¼‰ã¯æ¥µåŠ›ç½®ã‹ãªã„

---

## 7) scriptsã®è¿½åŠ ã¯ã€Œã‚³ãƒãƒ³ãƒ‰ã§ã‚„ã‚‹ã€ã¨äº‹æ•…ã‚‰ãªã„ğŸ› ï¸âœ¨

package.json ã‚’æ‰‹ã§ã„ã˜ã£ã¦ã‚‚ã„ã„ã‚“ã ã‘ã©ã€ã‚¿ã‚¤ãƒãŒæ€–ã„ãªã‚‰ã“ã‚ŒğŸ‘‡

* `npm set-script`ï¼šscriptsã‚’è¿½åŠ /æ›´æ–°ã§ãã‚‹([docs.npmjs.com][7])

ä¾‹ï¼š

```bash
npm set-script dev "npm run docker:up"
npm set-script docker:up "docker compose up --build"
npm set-script docker:logs "docker compose logs -f --tail=200"
```

---

## 8) ãƒŸãƒ‹èª²é¡Œï¼ˆ10ã€œ20åˆ†ï¼‰ğŸ§ªğŸ®

1. `npm set-script` ã§ã€æ¬¡ã®3ã¤ã‚’è¿½åŠ 

   * `dev`
   * `docker:up`
   * `docker:logs` ([docs.npmjs.com][7])
2. `npm run` ã‚’æ‰“ã£ã¦ã€**ä¸€è¦§ãŒå‡ºã‚‹**ã®ã‚’ç¢ºèªï¼ˆâ€œè¿·ã£ãŸã‚‰ã“ã“â€ï¼‰([docs.npmjs.com][1])
3. `npm run dev` â†’ åˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ `npm run docker:logs`
4. `scripts/help.mjs` ã‚’ä½œã£ã¦ `npm run help` ã‚’è¡¨ç¤ºã§ããŸã‚‰å‹ã¡ğŸ†âœ¨

---

## 9) AIæ‹¡å¼µã®ä½¿ã„ã©ã“ã‚ï¼ˆCopilot / Codexå‘ã‘ï¼‰ğŸ¤–âœ¨

AIã¯ã€Œ**è¨­è¨ˆæ„å›³ã‚’æ¸¡ã™â†’æ¡ˆã‚’å‡ºã•ã›ã‚‹â†’å·®åˆ†ãƒ¬ãƒ“ãƒ¥ãƒ¼**ã€ãŒä¸€ç•ªå®‰å…¨ã§ã™ğŸ‘

### ãã®ã¾ã¾ä½¿ãˆã‚‹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹ğŸ

* **scriptsè¨­è¨ˆã‚’ä½œã‚‰ã›ã‚‹**

  * ã€Œpackage.json ã® scripts ã‚’ã€â€œå…¥å£ã¯ dev/test/lint/format/typecheck ã«å›ºå®šã€æ´¾ç”Ÿã¯ colon è¨˜æ³•ã€docker compose æ“ä½œã¯ docker:* ã«ã¾ã¨ã‚ã‚‹â€æ–¹é‡ã§ææ¡ˆã—ã¦ã€‚Windowsã§å£Šã‚Œã‚„ã™ã„æ›¸ãæ–¹ã¯é¿ã‘ã¦ã€

* **help.mjs ã‚’ä½œã‚‰ã›ã‚‹**

  * ã€Œnpm run help ã§è¡¨ç¤ºã™ã‚‹ help.mjs ã‚’ä½œã£ã¦ã€‚åˆå¿ƒè€…å‘ã‘ã«çŸ­ãã€ã‚ˆãä½¿ã†é †ã§ã€‚çµµæ–‡å­—ã‚‚å°‘ã—å…¥ã‚Œã¦ã€

* **å±é™ºãƒã‚¤ãƒ³ãƒˆã‚’ãƒã‚§ãƒƒã‚¯ã•ã›ã‚‹**

  * ã€Œã“ã® scripts ã¯ Windows ã§å£Šã‚Œã‚„ã™ã„éƒ¨åˆ†ã‚ã‚‹ï¼Ÿç’°å¢ƒå¤‰æ•°ã€ãƒ‘ã‚¹ã€ä¸¦åˆ—å®Ÿè¡Œã€ã‚¯ã‚©ãƒ¼ãƒˆã®è¦³ç‚¹ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ã€

---

## 10) ã¾ã¨ã‚ï¼ˆã“ã®ç« ã§â€œå®Œæˆâ€ã—ãŸçŠ¶æ…‹ï¼‰ğŸ‰

* `npm run dev` ã ã‘è¦šãˆã‚Œã°é–‹ç™ºãŒå§‹ã¾ã‚‹ğŸš€
* `npm run` ã§ä¸€è¦§ã‚’å‡ºã—ã¦è¿·å­ã«ãªã‚‰ãªã„ğŸ§­([docs.npmjs.com][1])
* Dockerã®é•·æ–‡ã‚³ãƒãƒ³ãƒ‰ã¯ `docker:*` ã«éš”é›¢ã—ã¦ã€æ™®æ®µã¯è¦‹ãªãã¦ã„ã„ğŸ«¥
* Windowsã®ç½ ï¼ˆç’°å¢ƒå¤‰æ•°/ä¸¦åˆ—ï¼‰ã‚’æœ€åˆã‹ã‚‰æ½°ã™ğŸ’¥ï¼ˆ`cross-env` ã‚„ `npm-run-all` ç­‰ï¼‰([npm][4])

æ¬¡ã®ç¬¬28ç« ã§ã¯ã€ã“ã® `docker:*` ã‚’ã•ã‚‰ã«æ•´ç†ã—ã¦ **Composeæ“ä½œã‚‚å®Œå…¨ãƒ¯ãƒ³ã‚³ãƒãƒ³ãƒ‰åŒ–**ã—ã¦ã„ãã¾ã™ğŸ§±â¡ï¸ğŸ–±ï¸âœ¨

[1]: https://docs.npmjs.com/cli/v11/commands/npm-run/?utm_source=chatgpt.com "npm-run"
[2]: https://nodejs.org/en/blog/release/v24.0.0?utm_source=chatgpt.com "Node.js 24.0.0 (Current)"
[3]: https://docs.npmjs.com/cli/v8/using-npm/scripts/?utm_source=chatgpt.com "scripts | npm Docs"
[4]: https://www.npmjs.com/package/cross-env?utm_source=chatgpt.com "cross-env"
[5]: https://github.com/mysticatea/npm-run-all?utm_source=chatgpt.com "mysticatea/npm-run-all: A CLI tool ..."
[6]: https://docs.npmjs.com/cli/v10/using-npm/scripts/?utm_source=chatgpt.com "scripts"
[7]: https://docs.npmjs.com/cli/v7/commands/npm-set-script/?utm_source=chatgpt.com "npm-set-script"
